---
title: "Habitat_Model_VZH"
format: html
---

# Load packages 
```{r}
#clear R environment
rm(list = ls())

# check for a package, install and load 
pkgCheck <- function(x){ 
  if (!require(x,character.only = TRUE)){
    install.packages(x,dependencies=TRUE)
    if(!require(x,character.only = TRUE)) {
      stop()
    }
  }
}

pkgCheck("raster")
pkgCheck("spsurvey")
pkgCheck("terra")
pkgCheck("raster")
pkgCheck("ggplot2")
pkgCheck("tibble")
pkgCheck("readr")
pkgCheck("dplyr")
pkgCheck("tidyr")
pkgCheck("scales")

# load self-written functions 
source("mth_functions.R")
```

# Habitat Model FOEN
## Landqaurt: L2
```{r}
# L2 with Q: 2.4 m3/s
L2_2 <- foen_hm(raster_path = "raster_files/L2_v_2.tif", 
                base_flow = "raster_files/L2_v_2.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_2.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_2.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_2.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_2.tif", 
                river = "L2", discharge = 2.4)

# L2 with Q: 3.9 m3/s
L2_3 <- foen_hm(raster_path = "raster_files/L2_v_3.tif", 
                base_flow = "raster_files/L2_v_3.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_3.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_3.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_3.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_3.tif", 
                river = "L2", discharge = 3.9)

# L2 with Q: 4.6 m3/s
L2_4 <- foen_hm(raster_path = "raster_files/L2_v_4.tif", 
                base_flow = "raster_files/L2_v_4.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_4.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_4.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv",
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_4.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_4.tif", 
                river = "L2", discharge = 4.6)

# L2 with Q: 7 m3/s
L2_7 <- foen_hm(raster_path = "raster_files/L2_v_7.tif", 
                base_flow = "raster_files/L2_v_7.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_7.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_7.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_7.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_7.tif", 
                river = "L2", discharge = 7)

# L2 with Q: 9.24 m3/s
L2_9 <- foen_hm(raster_path = "raster_files/L2_v_9.tif", 
                base_flow = "raster_files/L2_v_9.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_9.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_9.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_9.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_9.tif", 
                river = "L2", discharge = 9.24)

# L2 with Q: 11.4 m3/s
L2_11 <- foen_hm(raster_path = "raster_files/L2_v_11.tif", 
                base_flow = "raster_files/L2_v_11.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_11.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_11.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_11.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_11.tif", 
                river = "L2", discharge = 11.4)

# L2 with Q: 13.3 m3/s
L2_13 <- foen_hm(raster_path = "raster_files/L2_v_13.tif", 
                base_flow = "raster_files/L2_v_13.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_13.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_13.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_13.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_13.tif", 
                river = "L2", discharge = 13.3)

# L2 with Q: 15 m3/s
L2_15 <- foen_hm(raster_path = "raster_files/L2_v_15.tif", 
                base_flow = "raster_files/L2_v_15.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_15.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_15.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_15.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_15.tif", 
                river = "L2", discharge = 15)

# L2 with Q: 18.9 m3/s
L2_18 <- foen_hm(raster_path = "raster_files/L2_v_18.tif", 
                base_flow = "raster_files/L2_v_18.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_18.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_18.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_18.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_18.tif", 
                river = "L2", discharge = 18.9)
```



## Moesa: MR
```{r}

```


# Bind Metric Results 
```{r}
# metrics
metric_results <- rbind(L2_2$metrics, L2_3$metrics, L2_4$metrics,
                        L2_7$metrics, L2_9$metrics, L2_11$metrics,
                        L2_13$metrics,L2_15$metrics, L2_18$metrics)

# safe df into .csv file
write.csv(metric_results, file = "results_foen/results_foen_metrics.csv", row.names = FALSE)

# freq_tables
freq_tables <- rbind(L2_2$freq, L2_3$freq, L2_4$freq, L2_7$freq, L2_9$freq,
                     L2_11$freq, L2_13$freq, L2_15$freq, L2_18$freq)

# write data frame into .csv file
write.csv(freq_tables, file = "results_foen/results_foen_freq_tables.csv", row.names = FALSE)
```




