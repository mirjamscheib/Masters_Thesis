---
title: "Hydrodynamic_Model_Results"
format: html
---

# Load packages
```{r}
# clear R memory 
rm(list = ls())

# load packages 
pkgCheck <- function(x){ 
  if (!require(x,character.only = TRUE)){
    install.packages(x,dependencies=TRUE)
    if(!require(x,character.only = TRUE)) {
      stop()
    }
  }
}

pkgCheck("raster")
pkgCheck("spsurvey")
pkgCheck("terra")
pkgCheck("ggplot2")
pkgCheck("tibble")
pkgCheck("readr")
pkgCheck("dplyr")
pkgCheck("tidyr")
pkgCheck("scales")
pkgCheck("hdf5r")
pkgCheck("sp")
pkgCheck("sf")
pkgCheck("spatstat.geom")
pkgCheck("spatstat.explore")
pkgCheck("gstat")
pkgCheck("purrr")
pkgCheck("rgdal")

# load self-written functions 
source("mth_functions.R")
```

# Convert Hydrodynamic Model Results 
## Landquart: L2
### Single Attribute Rasters
```{r}
# L2 with Q: 2.4 m3/s
L2_2 <- hdm_results(
  h5_path = "hdm_results/results_2.4_L2.h5", 
  twodm_path = "hdm_results/L2_mesh.2dm",
  shp_path = "raster_files/L2_shape.shp", 
  raster_v_path = "raster_files/L2_v_2.tif",
  raster_wd_path = "raster_files/L2_wd_2.tif")

# L2 with Q: 3.9 m3/s
L2_3 <- hdm_results(
  h5_path = "hdm_results/results_3.9_L2.h5", 
  twodm_path = "hdm_results/L2_mesh.2dm",
  shp_path = "raster_files/L2_shape.shp", 
  raster_v_path = "raster_files/L2_v_3.tif",
  raster_wd_path = "raster_files/L2_wd_3.tif")

# L2 with Q: 4.6 m3/s
L2_4 <- hdm_results(
  h5_path = "hdm_results/results_4.6_L2.h5", 
  twodm_path = "hdm_results/L2_mesh.2dm",
  shp_path = "raster_files/L2_shape.shp", 
  raster_v_path = "raster_files/L2_v_4.tif",
  raster_wd_path = "raster_files/L2_wd_4.tif")

# L2 with Q: 7 m3/s
L2_7 <- hdm_results(
  h5_path = "hdm_results/results_7_L2.h5", 
  twodm_path = "hdm_results/L2_mesh.2dm",
  shp_path = "raster_files/L2_shape.shp", 
  raster_v_path = "raster_files/L2_v_7.tif",
  raster_wd_path = "raster_files/L2_wd_7.tif")

# L2 with Q: 9.24 m3/s
L2_9 <- hdm_results(
  h5_path = "hdm_results/results_9.24_L2.h5", 
  twodm_path = "hdm_results/L2_mesh.2dm",
  shp_path = "raster_files/L2_shape.shp", 
  raster_v_path = "raster_files/L2_v_9.tif",
  raster_wd_path = "raster_files/L2_wd_9.tif")

# L2 with Q: 11.4 m3/s
L2_11 <- hdm_results(
  h5_path = "hdm_results/results_11.4_L2.h5", 
  twodm_path = "hdm_results/L2_mesh.2dm",
  shp_path = "raster_files/L2_shape.shp", 
  raster_v_path = "raster_files/L2_v_11.tif",
  raster_wd_path = "raster_files/L2_wd_11.tif")

# L2 with Q: 13.3 m3/s
L2_13 <- hdm_results(
  h5_path = "hdm_results/results_13.3_L2.h5", 
  twodm_path = "hdm_results/L2_mesh.2dm",
  shp_path = "raster_files/L2_shape.shp", 
  raster_v_path = "raster_files/L2_v_13.tif",
  raster_wd_path = "raster_files/L2_wd_13.tif")

# L2 with Q: 15 m3/s
L2_15 <- hdm_results(
  h5_path = "hdm_results/results_15_L2.h5", 
  twodm_path = "hdm_results/L2_mesh.2dm",
  shp_path = "raster_files/L2_shape.shp", 
  raster_v_path = "raster_files/L2_v_15.tif",
  raster_wd_path = "raster_files/L2_wd_15.tif")

# L2 with Q: 18.9 m3/s
L2_18 <- hdm_results(
  h5_path = "hdm_results/results_18.9_L2.h5", 
  twodm_path = "hdm_results/L2_mesh.2dm",
  shp_path = "raster_files/L2_shape.shp", 
  raster_v_path = "raster_files/L2_v_18.tif",
  raster_wd_path = "raster_files/L2_wd_18.tif")
```

### Stacked Rasters 
```{r}
# L2 with Q: 2.4 m3/s
stack_raster(v_path = "raster_files/L2_v_2.tif",
             wd_path = "raster_files/L2_wd_2.tif",
             stack_path = "rasters_stacked/L2_2.grd")

# L2 with Q: 3.9 m3/s
stack_raster(v_path = "raster_files/L2_v_3.tif",
             wd_path = "raster_files/L2_wd_3.tif",
             stack_path = "rasters_stacked/L2_3.grd")

# L2 with Q: 4.6 m3/s
stack_raster(v_path = "raster_files/L2_v_4.tif",
             wd_path = "raster_files/L2_wd_4.tif",
             stack_path = "rasters_stacked/L2_4.grd")

# L2 with Q: 7 m3/s
stack_raster(v_path = "raster_files/L2_v_7.tif",
             wd_path = "raster_files/L2_wd_7.tif",
             stack_path = "rasters_stacked/L2_7.grd")

# L2 with Q: 9.24 m3/s
stack_raster(v_path = "raster_files/L2_v_9.tif",
             wd_path = "raster_files/L2_wd_9.tif",
             stack_path = "rasters_stacked/L2_9.grd")

# L2 with Q: 11.4 m3/s
stack_raster(v_path = "raster_files/L2_v_11.tif",
             wd_path = "raster_files/L2_wd_11.tif",
             stack_path = "rasters_stacked/L2_11.grd")

# L2 with Q: 13.3 m3/s
stack_raster(v_path = "raster_files/L2_v_13.tif",
             wd_path = "raster_files/L2_wd_13.tif",
             stack_path = "rasters_stacked/L2_13.grd")

# L2 with Q: 15 m3/s
stack_raster(v_path = "raster_files/L2_v_15.tif",
             wd_path = "raster_files/L2_wd_15.tif",
             stack_path = "rasters_stacked/L2_15.grd")

# L2 with Q: 18.9 m3/s
stack_raster(v_path = "raster_files/L2_v_18.tif",
             wd_path = "raster_files/L2_wd_18.tif",
             stack_path = "rasters_stacked/L2_18.grd")
```


## Moesa: MR
```{r}
```

## Moesa: M1
```{r}
```


