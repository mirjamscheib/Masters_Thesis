---
title: "froude_hdm"
format: html
---

# Libraries
```{r}
#clear R environment
rm(list = ls())

# check for a package, install and load 
pkgCheck <- function(x){ 
  if (!require(x,character.only = TRUE)){
    install.packages(x,dependencies=TRUE)
    if(!require(x,character.only = TRUE)) {
      stop()
    }
  }
}

pkgCheck("sf")
pkgCheck("terra")
pkgCheck("dplyr")
pkgCheck("data.table")  # fast data.frame manipulation (used by mlr3)
pkgCheck("readr")
pkgCheck("sp")
pkgCheck("raster")
pkgCheck("Metrics")
pkgCheck("tidyr")
```

# Rasters
## Read rasters
```{r}
# GL1 ---------------------------------------------------------------------
GL1_v_2_56_ezg <- raster("Pre_Processing/raster_files/GL1_v_2_56_ezg.tif")
GL1_wd_2_56_ezg <- raster("Pre_Processing/raster_files/GL1_wd_2_56_ezg.tif")

GL1_v_3_28 <- raster("Pre_Processing/raster_files/GL1_v_3_28.tif")
GL1_wd_3_28 <- raster("Pre_Processing/raster_files/GL1_wd_3_28.tif")

GL1_v_6_00 <- raster("Pre_Processing/raster_files/GL1_v_6_00.tif")
GL1_wd_6_00 <- raster("Pre_Processing/raster_files/GL1_wd_6_00.tif")

GL1_v_9_00 <- raster("Pre_Processing/raster_files/GL1_v_9_00.tif")
GL1_wd_9_00 <- raster("Pre_Processing/raster_files/GL1_wd_9_00.tif")

GL1_v_12_68 <- raster("Pre_Processing/raster_files/GL1_v_12_68.tif")
GL1_wd_12_68 <- raster("Pre_Processing/raster_files/GL1_wd_12_68.tif")

GL1_v_16_00 <- raster("Pre_Processing/raster_files/GL1_v_16_00.tif")
GL1_wd_16_00 <- raster("Pre_Processing/raster_files/GL1_wd_16_00.tif")

GL1_v_19_00 <- raster("Pre_Processing/raster_files/GL1_v_19_00.tif")
GL1_wd_19_00 <- raster("Pre_Processing/raster_files/GL1_wd_19_00.tif")

GL1_v_22_00 <- raster("Pre_Processing/raster_files/GL1_v_22_00.tif")
GL1_wd_22_00 <- raster("Pre_Processing/raster_files/GL1_wd_22_00.tif")

GL1_v_25_00 <- raster("Pre_Processing/raster_files/GL1_v_25_00.tif")
GL1_wd_25_00 <- raster("Pre_Processing/raster_files/GL1_wd_25_00.tif")

GL1_v_28_00 <- raster("Pre_Processing/raster_files/GL1_v_28_00.tif")
GL1_wd_28_00 <- raster("Pre_Processing/raster_files/GL1_wd_28_00.tif")

GL1_v_31_76 <- raster("Pre_Processing/raster_files/GL1_v_31_76.tif")
GL1_wd_31_76 <- raster("Pre_Processing/raster_files/GL1_wd_31_76.tif")

# GL2 ---------------------------------------------------------------------
GL2_v_2_37_ezg <- raster("Pre_Processing/raster_files/GL2_v_2_37_ezg.tif")
GL2_wd_2_37_ezg <- raster("Pre_Processing/raster_files/GL2_wd_2_37_ezg.tif")

GL2_v_3_21 <- raster("Pre_Processing/raster_files/GL2_v_3_21.tif")
GL2_wd_3_21 <- raster("Pre_Processing/raster_files/GL2_wd_3_21.tif")

GL2_v_6_00 <- raster("Pre_Processing/raster_files/GL2_v_6_00.tif")
GL2_wd_6_00 <- raster("Pre_Processing/raster_files/GL2_wd_6_00.tif")

GL2_v_9_00 <- raster("Pre_Processing/raster_files/GL2_v_9_00.tif")
GL2_wd_9_00 <- raster("Pre_Processing/raster_files/GL2_wd_9_00.tif")

GL2_v_11_00 <- raster("Pre_Processing/raster_files/GL2_v_11_00.tif")
GL2_wd_11_00 <- raster("Pre_Processing/raster_files/GL2_wd_11_00.tif")

GL2_v_12_52 <- raster("Pre_Processing/raster_files/GL2_v_12_52.tif")
GL2_wd_12_52 <- raster("Pre_Processing/raster_files/GL2_wd_12_52.tif")

GL2_v_16_00 <- raster("Pre_Processing/raster_files/GL2_v_16_00.tif")
GL2_wd_16_00 <- raster("Pre_Processing/raster_files/GL2_wd_16_00.tif")

GL2_v_19_00 <- raster("Pre_Processing/raster_files/GL2_v_19_00.tif")
GL2_wd_19_00 <- raster("Pre_Processing/raster_files/GL2_wd_19_00.tif")

GL2_v_22_00 <- raster("Pre_Processing/raster_files/GL2_v_22_00.tif")
GL2_wd_22_00 <- raster("Pre_Processing/raster_files/GL2_wd_22_00.tif")

GL2_v_25_00 <- raster("Pre_Processing/raster_files/GL2_v_25_00.tif")
GL2_wd_25_00 <- raster("Pre_Processing/raster_files/GL2_wd_25_00.tif")

GL2_v_28_00 <- raster("Pre_Processing/raster_files/GL2_v_28_00.tif")
GL2_wd_28_00 <- raster("Pre_Processing/raster_files/GL2_wd_28_00.tif")

GL2_v_31_53 <- raster("Pre_Processing/raster_files/GL2_v_31_53.tif")
GL2_wd_31_53 <- raster("Pre_Processing/raster_files/GL2_wd_31_53.tif")

# L2 ---------------------------------------------------------------------
L2_v_2_40 <- raster("Pre_Processing/raster_files/L2_v_2_40.tif")
L2_wd_2_40 <- raster("Pre_Processing/raster_files/L2_wd_2_40.tif")

L2_v_3_90 <- raster("Pre_Processing/raster_files/L2_v_3_90.tif")
L2_wd_3_90 <- raster("Pre_Processing/raster_files/L2_wd_3_90.tif")

L2_v_7_00 <- raster("Pre_Processing/raster_files/L2_v_7_00.tif")
L2_wd_7_00 <- raster("Pre_Processing/raster_files/L2_wd_7_00.tif")

L2_v_9_24 <- raster("Pre_Processing/raster_files/L2_v_9_24.tif")
L2_wd_9_24 <- raster("Pre_Processing/raster_files/L2_wd_9_24.tif")

L2_v_9_54_ezg <- raster("Pre_Processing/raster_files/L2_v_9_54_ezg.tif")
L2_wd_9_54_ezg <- raster("Pre_Processing/raster_files/L2_wd_9_54_ezg.tif")

L2_v_13_30 <- raster("Pre_Processing/raster_files/L2_v_13_30.tif")
L2_wd_13_30 <- raster("Pre_Processing/raster_files/L2_wd_13_30.tif")

L2_v_16_50 <- raster("Pre_Processing/raster_files/L2_v_16_50.tif")
L2_wd_16_50 <- raster("Pre_Processing/raster_files/L2_wd_16_50.tif")

L2_v_18_90 <- raster("Pre_Processing/raster_files/L2_v_18_90.tif")
L2_wd_18_90 <- raster("Pre_Processing/raster_files/L2_wd_18_90.tif")

# M1 -------------------------------------------------------------------
M1_v_0_47 <- raster("Pre_Processing/raster_files/M1_v_0_47.tif")
M1_wd_0_47 <- raster("Pre_Processing/raster_files/M1_wd_0_47.tif")

M1_v_0_60 <- raster("Pre_Processing/raster_files/M1_v_0_60.tif")
M1_wd_0_60 <- raster("Pre_Processing/raster_files/M1_wd_0_60.tif")

M1_v_1_50_ezg <- raster("Pre_Processing/raster_files/M1_v_1_50_ezg.tif")
M1_wd_1_50_ezg <- raster("Pre_Processing/raster_files/M1_wd_1_50_ezg.tif")

M1_v_4_00 <- raster("Pre_Processing/raster_files/M1_v_4_00.tif")
M1_wd_4_00 <- raster("Pre_Processing/raster_files/M1_wd_4_00.tif")

M1_v_6_00 <- raster("Pre_Processing/raster_files/M1_v_6_00.tif")
M1_wd_6_00 <- raster("Pre_Processing/raster_files/M1_wd_6_00.tif")

M1_v_8_00 <- raster("Pre_Processing/raster_files/M1_v_8_00.tif")
M1_wd_8_00 <- raster("Pre_Processing/raster_files/M1_wd_8_00.tif")

M1_v_10_00 <- raster("Pre_Processing/raster_files/M1_v_10_00.tif")
M1_wd_10_00 <- raster("Pre_Processing/raster_files/M1_wd_10_00.tif")

M1_v_12_00 <- raster("Pre_Processing/raster_files/M1_v_12_00.tif")
M1_wd_12_00 <- raster("Pre_Processing/raster_files/M1_wd_12_00.tif")

M1_v_14_00 <- raster("Pre_Processing/raster_files/M1_v_14_00.tif")
M1_wd_14_00 <- raster("Pre_Processing/raster_files/M1_wd_14_00.tif")

M1_v_16_00 <- raster("Pre_Processing/raster_files/M1_v_16_00.tif")
M1_wd_16_00 <- raster("Pre_Processing/raster_files/M1_wd_16_00.tif")

M1_v_18_84 <- raster("Pre_Processing/raster_files/M1_v_18_84.tif")
M1_wd_18_84 <- raster("Pre_Processing/raster_files/M1_wd_18_84.tif")

M1_v_22_84 <- raster("Pre_Processing/raster_files/M1_v_22_84.tif")
M1_wd_22_84 <- raster("Pre_Processing/raster_files/M1_wd_22_84.tif")

# S1 -------------------------------------------------------------------
S1_v_1_94_ezg <- raster("Pre_Processing/raster_files/S1_v_1_94_ezg.tif")
S1_wd_1_94_ezg <- raster("Pre_Processing/raster_files/S1_wd_1_94_ezg.tif")

S1_v_2_00 <- raster("Pre_Processing/raster_files/S1_v_2_00.tif")
S1_wd_2_00 <- raster("Pre_Processing/raster_files/S1_wd_2_00.tif")

S1_v_3_70 <- raster("Pre_Processing/raster_files/S1_v_3_70.tif")
S1_wd_3_70 <- raster("Pre_Processing/raster_files/S1_wd_3_70.tif")

S1_v_6_50 <- raster("Pre_Processing/raster_files/S1_v_6_50.tif")
S1_wd_6_50 <- raster("Pre_Processing/raster_files/S1_wd_6_50.tif")

S1_v_8_50 <- raster("Pre_Processing/raster_files/S1_v_8_50.tif")
S1_wd_8_50 <- raster("Pre_Processing/raster_files/S1_wd_8_50.tif")

S1_v_10_68 <- raster("Pre_Processing/raster_files/S1_v_10_68.tif")
S1_wd_10_68 <- raster("Pre_Processing/raster_files/S1_wd_10_68.tif")

S1_v_13_00 <- raster("Pre_Processing/raster_files/S1_v_13_00.tif")
S1_wd_13_00 <- raster("Pre_Processing/raster_files/S1_wd_13_00.tif")

S1_v_15_00 <- raster("Pre_Processing/raster_files/S1_v_15_00.tif")
S1_wd_15_00 <- raster("Pre_Processing/raster_files/S1_wd_15_00.tif")

S1_v_18_00 <- raster("Pre_Processing/raster_files/S1_v_18_00.tif")
S1_wd_18_00 <- raster("Pre_Processing/raster_files/S1_wd_18_00.tif")

S1_v_20_00 <- raster("Pre_Processing/raster_files/S1_v_20_00.tif")
S1_wd_20_00 <- raster("Pre_Processing/raster_files/S1_wd_20_00.tif")

# S2 ----------------------------------------------------------------
S2_v_1_93_ezg <- raster("Pre_Processing/raster_files/S2_v_1_93_ezg.tif")
S2_wd_1_93_ezg <- raster("Pre_Processing/raster_files/S2_wd_1_93_ezg.tif")

S2_v_2_00 <- raster("Pre_Processing/raster_files/S2_v_2_00.tif")
S2_wd_2_00 <- raster("Pre_Processing/raster_files/S2_wd_2_00.tif")

S2_v_3_20 <- raster("Pre_Processing/raster_files/S2_v_3_20.tif")
S2_wd_3_20 <- raster("Pre_Processing/raster_files/S2_wd_3_20.tif")

S2_v_6_50 <- raster("Pre_Processing/raster_files/S2_v_6_50.tif")
S2_wd_6_50 <- raster("Pre_Processing/raster_files/S2_wd_6_50.tif")

S2_v_8_50 <- raster("Pre_Processing/raster_files/S2_v_8_50.tif")
S2_wd_8_50 <- raster("Pre_Processing/raster_files/S2_wd_8_50.tif")

S2_v_10_93 <- raster("Pre_Processing/raster_files/S2_v_10_93.tif")
S2_wd_10_93 <- raster("Pre_Processing/raster_files/S2_wd_10_93.tif")

S2_v_13_00 <- raster("Pre_Processing/raster_files/S2_v_13_00.tif")
S2_wd_13_00 <- raster("Pre_Processing/raster_files/S2_wd_13_00.tif")

S2_v_15_00 <- raster("Pre_Processing/raster_files/S2_v_15_00.tif")
S2_wd_15_00 <- raster("Pre_Processing/raster_files/S2_wd_15_00.tif")

S2_v_18_00 <- raster("Pre_Processing/raster_files/S2_v_18_00.tif")
S2_wd_18_00 <- raster("Pre_Processing/raster_files/S2_wd_18_00.tif")

S2_v_20_00 <- raster("Pre_Processing/raster_files/S2_v_20_00.tif")
S2_wd_20_00 <- raster("Pre_Processing/raster_files/S2_wd_20_00.tif")

# TH4 ---------------------------------------------------------------
TH4_v_11_45 <- raster("Pre_Processing/raster_files/TH4_v_11_45.tif")
TH4_wd_11_45 <- raster("Pre_Processing/raster_files/TH4_wd_11_45.tif")

TH4_v_15_00 <- raster("Pre_Processing/raster_files/TH4_v_15_00.tif")
TH4_wd_15_00 <- raster("Pre_Processing/raster_files/TH4_wd_15_00.tif")

TH4_v_18_00 <- raster("Pre_Processing/raster_files/TH4_v_18_00.tif")
TH4_wd_18_00 <- raster("Pre_Processing/raster_files/TH4_wd_18_00.tif")

TH4_v_19_96 <- raster("Pre_Processing/raster_files/TH4_v_19_96.tif")
TH4_wd_19_96 <- raster("Pre_Processing/raster_files/TH4_wd_19_96.tif")

TH4_v_22_50 <- raster("Pre_Processing/raster_files/TH4_v_22_50.tif")
TH4_wd_22_50 <- raster("Pre_Processing/raster_files/TH4_wd_22_50.tif")

TH4_v_25_00 <- raster("Pre_Processing/raster_files/TH4_v_25_00.tif")
TH4_wd_25_00 <- raster("Pre_Processing/raster_files/TH4_wd_25_00.tif")

TH4_v_27_00 <- raster("Pre_Processing/raster_files/TH4_v_27_00.tif")
TH4_wd_27_00 <- raster("Pre_Processing/raster_files/TH4_wd_27_00.tif")

TH4_v_30_00 <- raster("Pre_Processing/raster_files/TH4_v_30_00.tif")
TH4_wd_30_00 <- raster("Pre_Processing/raster_files/TH4_wd_30_00.tif")

TH4_v_32_93 <- raster("Pre_Processing/raster_files/TH4_v_32_93.tif")
TH4_wd_32_93 <- raster("Pre_Processing/raster_files/TH4_wd_32_93.tif")

TH4_v_35_12_ezg <- raster("Pre_Processing/raster_files/TH4_v_35_12_ezg.tif")
TH4_wd_35_12_ezg <- raster("Pre_Processing/raster_files/TH4_wd_35_12_ezg.tif")

# VR3 --------------------------------------------------------------------
VR3_v_2_90 <- raster("Pre_Processing/raster_files/VR3_v_2_90.tif")
VR3_wd_2_90 <- raster("Pre_Processing/raster_files/VR3_wd_2_90.tif")

VR3_v_6_00 <- raster("Pre_Processing/raster_files/VR3_v_6_00.tif")
VR3_wd_6_00 <- raster("Pre_Processing/raster_files/VR3_wd_6_00.tif")

VR3_v_9_00 <- raster("Pre_Processing/raster_files/VR3_v_9_00.tif")
VR3_wd_9_00 <- raster("Pre_Processing/raster_files/VR3_wd_9_00.tif")

VR3_v_12_00 <- raster("Pre_Processing/raster_files/VR3_v_12_00.tif")
VR3_wd_12_00 <- raster("Pre_Processing/raster_files/VR3_wd_12_00.tif")

VR3_v_15_00 <- raster("Pre_Processing/raster_files/VR3_v_15_00.tif")
VR3_wd_15_00 <- raster("Pre_Processing/raster_files/VR3_wd_15_00.tif")

VR3_v_18_80 <- raster("Pre_Processing/raster_files/VR3_v_18_80.tif")
VR3_wd_18_80 <- raster("Pre_Processing/raster_files/VR3_wd_18_80.tif")

VR3_v_21_51_ezg <- raster("Pre_Processing/raster_files/VR3_v_21_51_ezg.tif")
VR3_wd_21_51_ezg <- raster("Pre_Processing/raster_files/VR3_wd_21_51_ezg.tif")

VR3_v_22_00 <- raster("Pre_Processing/raster_files/VR3_v_22_00.tif")
VR3_wd_22_00 <- raster("Pre_Processing/raster_files/VR3_wd_22_00.tif")

VR3_v_25_00 <- raster("Pre_Processing/raster_files/VR3_v_25_00.tif")
VR3_wd_25_00 <- raster("Pre_Processing/raster_files/VR3_wd_25_00.tif")

VR3_v_28_00 <- raster("Pre_Processing/raster_files/VR3_v_28_00.tif")
VR3_wd_28_00 <- raster("Pre_Processing/raster_files/VR3_wd_28_00.tif")

VR3_v_31_00 <- raster("Pre_Processing/raster_files/VR3_v_31_00.tif")
VR3_wd_31_00 <- raster("Pre_Processing/raster_files/VR3_wd_31_00.tif")

VR3_v_34_00 <- raster("Pre_Processing/raster_files/VR3_v_34_00.tif")
VR3_wd_34_00 <- raster("Pre_Processing/raster_files/VR3_wd_34_00.tif")

VR3_v_37_00 <- raster("Pre_Processing/raster_files/VR3_v_37_00.tif")
VR3_wd_37_00 <- raster("Pre_Processing/raster_files/VR3_wd_37_00.tif")

VR3_v_40_10 <- raster("Pre_Processing/raster_files/VR3_v_40_10.tif")
VR3_wd_40_10 <- raster("Pre_Processing/raster_files/VR3_wd_40_10.tif")

VR3_v_43_00 <- raster("Pre_Processing/raster_files/VR3_v_43_00.tif")
VR3_wd_43_00 <- raster("Pre_Processing/raster_files/VR3_wd_43_00.tif")

VR3_v_46_00 <- raster("Pre_Processing/raster_files/VR3_v_46_00.tif")
VR3_wd_46_00 <- raster("Pre_Processing/raster_files/VR3_wd_46_00.tif")

VR3_v_48_00 <- raster("Pre_Processing/raster_files/VR3_v_48_00.tif")
VR3_wd_48_00 <- raster("Pre_Processing/raster_files/VR3_wd_48_00.tif")

VR3_v_50_00 <- raster("Pre_Processing/raster_files/VR3_v_50_00.tif")
VR3_wd_50_00 <- raster("Pre_Processing/raster_files/VR3_wd_50_00.tif")

VR3_v_52_90 <- raster("Pre_Processing/raster_files/VR3_v_52_90.tif")
VR3_wd_52_90 <- raster("Pre_Processing/raster_files/VR3_wd_52_90.tif")
```


```{r}
# assign coordinate system 
crs(GL1_v_3_28) <- "EPSG: 2056"
crs(GL1_wd_3_28) <- "EPSG: 2056"
```

# Daten laden 
```{r}
data_v <- read_delim("Pre_Processing/abiotic_mi_sampling/lab_ml_v.csv")
data_wd <- read_delim("Pre_Processing/abiotic_mi_sampling/lab_ml_wd_v.csv")
data_sampling <- read_delim("Pre_Processing/abiotic_mi_sampling/lab_ml_sampling.csv")
data_section <- read_delim("Pre_Processing/abiotic_mi_sampling/lab_ml_section.csv")
```

# Parameter calculations
## Froude
### GL1
```{r}
GL1_f_2_56_ezg <- GL1_v_2_56_ezg/(sqrt(9.81 * GL1_wd_2_56_ezg))
GL1_f_3_28 <- GL1_v_3_28/(sqrt(9.81 * GL1_wd_3_28))
GL1_f_6_00 <- GL1_v_6_00/(sqrt(9.81 * GL1_wd_6_00))
GL1_f_9_00 <- GL1_v_9_00/(sqrt(9.81 * GL1_wd_9_00))
GL1_f_12_68 <- GL1_v_12_68/(sqrt(9.81 * GL1_wd_12_68))
GL1_f_16_00 <- GL1_v_16_00/(sqrt(9.81 * GL1_wd_16_00))
GL1_f_19_00 <- GL1_v_19_00/(sqrt(9.81 * GL1_wd_19_00))
GL1_f_22_00 <- GL1_v_22_00/(sqrt(9.81 * GL1_wd_22_00))
GL1_f_25_00 <- GL1_v_25_00/(sqrt(9.81 * GL1_wd_25_00))
GL1_f_28_00 <- GL1_v_28_00/(sqrt(9.81 * GL1_wd_28_00))
GL1_f_31_76 <- GL1_v_31_76/(sqrt(9.81 * GL1_wd_31_76))
```

### GL2
```{r}
GL2_f_2_37_ezg <- GL2_v_2_37_ezg/(sqrt(9.81 * GL2_wd_2_37_ezg))
GL2_f_3_21 <- GL2_v_3_21/(sqrt(9.81 * GL2_wd_3_21))
GL2_f_6_00 <- GL2_v_6_00/(sqrt(9.81 * GL2_wd_6_00))
GL2_f_9_00 <- GL2_v_9_00/(sqrt(9.81 * GL2_wd_9_00))
GL2_f_11_00 <- GL2_v_11_00/(sqrt(9.81 * GL2_wd_11_00))
GL2_f_12_52 <- GL2_v_12_52/(sqrt(9.81 * GL2_wd_12_52))
GL2_f_16_00 <- GL2_v_16_00/(sqrt(9.81 * GL2_wd_16_00))
GL2_f_19_00 <- GL2_v_19_00/(sqrt(9.81 * GL2_wd_19_00))
GL2_f_22_00 <- GL2_v_22_00/(sqrt(9.81 * GL2_wd_22_00))
GL2_f_25_00 <- GL2_v_25_00/(sqrt(9.81 * GL2_wd_25_00))
GL2_f_28_00 <- GL2_v_28_00/(sqrt(9.81 * GL2_wd_28_00))
GL2_f_31_53 <- GL2_v_31_53/(sqrt(9.81 * GL2_wd_31_53))
```

### L2
```{r}
L2_f_2_40 <- L2_v_2_40/(sqrt(9.81 * L2_wd_2_40))
L2_f_3_90 <- L2_v_3_90/(sqrt(9.81 * L2_wd_3_90))
L2_f_7_00 <- L2_v_7_00/(sqrt(9.81 * L2_wd_7_00))
L2_f_9_24 <- L2_v_9_24/(sqrt(9.81 * L2_wd_9_24))
L2_f_9_54_ezg <- L2_v_9_54_ezg/(sqrt(9.81 * L2_wd_9_54_ezg))
L2_f_13_30 <- L2_v_13_30/(sqrt(9.81 * L2_wd_13_30))
L2_f_16_50 <- L2_v_16_50/(sqrt(9.81 * L2_wd_16_50))
L2_f_18_90 <- L2_v_18_90/(sqrt(9.81 * L2_wd_18_90))
```

### M1
```{r}
M1_f_0_47 <- M1_v_0_47/(sqrt(9.81 * M1_wd_0_47))
M1_f_0_60 <- M1_v_0_60/(sqrt(9.81 * M1_wd_0_60))
M1_f_1_50_ezg <- M1_v_1_50_ezg/(sqrt(9.81 * M1_wd_1_50_ezg))
M1_f_4_00 <- M1_v_4_00/(sqrt(9.81 * M1_wd_4_00))
M1_f_6_00 <- M1_v_6_00/(sqrt(9.81 * M1_wd_6_00))
M1_f_8_00 <- M1_v_8_00/(sqrt(9.81 * M1_wd_8_00))
M1_f_10_00 <- M1_v_10_00/(sqrt(9.81 * M1_wd_10_00))
M1_f_12_00 <- M1_v_12_00/(sqrt(9.81 * M1_wd_12_00))
M1_f_14_00 <- M1_v_14_00/(sqrt(9.81 * M1_wd_14_00))
M1_f_16_00 <- M1_v_16_00/(sqrt(9.81 * M1_wd_16_00))
M1_f_18_84 <- M1_v_18_84/(sqrt(9.81 * M1_wd_18_84))
M1_f_22_84 <- M1_v_22_84/(sqrt(9.81 * M1_wd_22_84))
```

### S1
```{r}
S1_f_1_94_ezg <- S1_v_1_94_ezg/(sqrt(9.81 * S1_wd_1_94_ezg))
S1_f_2_00 <- S1_v_2_00/(sqrt(9.81 * S1_wd_2_00))
S1_f_3_70 <- S1_v_3_70/(sqrt(9.81 * S1_wd_3_70))
S1_f_6_50 <- S1_v_6_50/(sqrt(9.81 * S1_wd_6_50))
S1_f_8_50 <- S1_v_8_50/(sqrt(9.81 * S1_wd_8_50))
S1_f_10_68 <- S1_v_10_68/(sqrt(9.81 * S1_wd_10_68))
S1_f_13_00 <- S1_v_13_00/(sqrt(9.81 * S1_wd_13_00))
S1_f_15_00 <- S1_v_15_00/(sqrt(9.81 * S1_wd_15_00))
S1_f_18_00 <- S1_v_18_00/(sqrt(9.81 * S1_wd_18_00))
S1_f_20_00 <- S1_v_20_00/(sqrt(9.81 * S1_wd_20_00))
```

### S2
```{r}
S2_f_1_93_ezg <- S2_v_1_93_ezg/(sqrt(9.81 * S2_wd_1_93_ezg))
S2_f_2_00 <- S2_v_2_00/(sqrt(9.81 * S2_wd_2_00))
S2_f_3_20 <- S2_v_3_20/(sqrt(9.81 * S2_wd_3_20))
S2_f_6_50 <- S2_v_6_50/(sqrt(9.81 * S2_wd_6_50))
S2_f_8_50 <- S2_v_8_50/(sqrt(9.81 * S2_wd_8_50))
S2_f_10_93 <- S2_v_10_93/(sqrt(9.81 * S2_wd_10_93))
S2_f_13_00 <- S2_v_13_00/(sqrt(9.81 * S2_wd_13_00))
S2_f_15_00 <- S2_v_15_00/(sqrt(9.81 * S2_wd_15_00))
S2_f_18_00 <- S2_v_18_00/(sqrt(9.81 * S2_wd_18_00))
S2_f_20_00 <- S2_v_20_00/(sqrt(9.81 * S2_wd_20_00))
```

### TH4
```{r}
TH4_f_11_45 <- TH4_v_11_45/(sqrt(9.81 * TH4_wd_11_45))
TH4_f_15_00 <- TH4_v_15_00/(sqrt(9.81 * TH4_wd_15_00))
TH4_f_18_00 <- TH4_v_18_00/(sqrt(9.81 * TH4_wd_18_00))
TH4_f_19_96 <- TH4_v_19_96/(sqrt(9.81 * TH4_wd_19_96))
TH4_f_22_50 <- TH4_v_22_50/(sqrt(9.81 * TH4_wd_22_50))
TH4_f_25_00 <- TH4_v_25_00/(sqrt(9.81 * TH4_wd_25_00))
TH4_f_27_00 <- TH4_v_27_00/(sqrt(9.81 * TH4_wd_27_00))
TH4_f_30_00 <- TH4_v_30_00/(sqrt(9.81 * TH4_wd_30_00))
TH4_f_32_93 <- TH4_v_32_93/(sqrt(9.81 * TH4_wd_32_93))
TH4_f_35_12_ezg <- TH4_v_35_12_ezg/(sqrt(9.81 * TH4_wd_35_12_ezg))
```

### VR3
```{r}
VR3_f_2_90 <- VR3_v_2_90/(sqrt(9.81 * VR3_wd_2_90))
VR3_f_6_00 <- VR3_v_6_00/(sqrt(9.81 * VR3_wd_6_00))
VR3_f_9_00 <- VR3_v_9_00/(sqrt(9.81 * VR3_wd_9_00))
VR3_f_12_00 <- VR3_v_12_00/(sqrt(9.81 * VR3_wd_12_00))
VR3_f_15_00 <- VR3_v_15_00/(sqrt(9.81 * VR3_wd_15_00))
VR3_f_18_80 <- VR3_v_18_80/(sqrt(9.81 * VR3_wd_18_80))
VR3_f_21_51_ezg <- VR3_v_21_51_ezg/(sqrt(9.81 * VR3_wd_21_51_ezg))
VR3_f_22_00 <- VR3_v_22_00/(sqrt(9.81 * VR3_wd_22_00))
VR3_f_25_00 <- VR3_v_25_00/(sqrt(9.81 * VR3_wd_25_00))
VR3_f_28_00 <- VR3_v_28_00/(sqrt(9.81 * VR3_wd_28_00))
VR3_f_31_00 <- VR3_v_31_00/(sqrt(9.81 * VR3_wd_31_00))
VR3_f_34_00 <- VR3_v_34_00/(sqrt(9.81 * VR3_wd_34_00))
VR3_f_37_00 <- VR3_v_37_00/(sqrt(9.81 * VR3_wd_37_00))
VR3_f_40_10 <- VR3_v_40_10/(sqrt(9.81 * VR3_wd_40_10))
VR3_f_43_00 <- VR3_v_43_00/(sqrt(9.81 * VR3_wd_43_00))
VR3_f_46_00 <- VR3_v_46_00/(sqrt(9.81 * VR3_wd_46_00))
VR3_f_48_00 <- VR3_v_48_00/(sqrt(9.81 * VR3_wd_48_00))
VR3_f_50_00 <- VR3_v_50_00/(sqrt(9.81 * VR3_wd_50_00))
VR3_f_52_90 <- VR3_v_52_90/(sqrt(9.81 * VR3_wd_52_90))
```

### Dataframe
```{r}
# calculate from dataframe for ML models
data_wd_f <- data_wd$velocity/(sqrt(9.81 * data_wd$wd_m))
```

## Sohlenschubspannung 
### GL1
```{r}
GL1_s_2_56_ezg <- (1000*9.81*(GL1_v_2_56_ezg)^2*(1/38)^2)/((GL1_wd_2_56_ezg)^1/3)
GL1_s_3_28 <- (1000*9.81*(GL1_v_3_28)^2*(1/38)^2)/((GL1_wd_3_28)^1/3)
GL1_s_6_00 <- (1000*9.81*(GL1_v_6_00)^2*(1/38)^2)/((GL1_wd_6_00)^1/3)
GL1_s_9_00 <- (1000*9.81*(GL1_v_9_00)^2*(1/38)^2)/((GL1_wd_9_00)^1/3)
GL1_s_12_68 <- (1000*9.81*(GL1_v_12_68)^2*(1/38)^2)/((GL1_wd_12_68)^1/3)
GL1_s_16_00 <- (1000*9.81*(GL1_v_16_00)^2*(1/38)^2)/((GL1_wd_16_00)^1/3)
GL1_s_19_00 <- (1000*9.81*(GL1_v_19_00)^2*(1/38)^2)/((GL1_wd_19_00)^1/3)
GL1_s_22_00 <- (1000*9.81*(GL1_v_22_00)^2*(1/38)^2)/((GL1_wd_22_00)^1/3)
GL1_s_25_00 <- (1000*9.81*(GL1_v_25_00)^2*(1/38)^2)/((GL1_wd_25_00)^1/3)
GL1_s_28_00 <- (1000*9.81*(GL1_v_28_00)^2*(1/38)^2)/((GL1_wd_28_00)^1/3)
GL1_s_31_76 <- (1000*9.81*(GL1_v_31_76)^2*(1/38)^2)/((GL1_wd_31_76)^1/3)
```

### GL2
```{r}
GL2_s_2_37_ezg <- (1000*9.81*(GL2_v_2_37_ezg)^2*(1/38)^2)/((GL2_wd_2_37_ezg)^1/3)
GL2_s_3_21 <- (1000*9.81*(GL2_v_3_21)^2*(1/38)^2)/((GL2_wd_3_21)^1/3)
GL2_s_6_00 <- (1000*9.81*(GL2_v_6_00)^2*(1/38)^2)/((GL2_wd_6_00)^1/3)
GL2_s_9_00 <- (1000*9.81*(GL2_v_9_00)^2*(1/38)^2)/((GL2_wd_9_00)^1/3)
GL2_s_11_00 <- (1000*9.81*(GL2_v_11_00)^2*(1/38)^2)/((GL2_wd_11_00)^1/3)
GL2_s_12_52 <- (1000*9.81*(GL2_v_12_52)^2*(1/38)^2)/((GL2_wd_12_52)^1/3)
GL2_s_16_00 <- (1000*9.81*(GL2_v_16_00)^2*(1/38)^2)/((GL2_wd_16_00)^1/3)
GL2_s_19_00 <- (1000*9.81*(GL2_v_19_00)^2*(1/38)^2)/((GL2_wd_19_00)^1/3)
GL2_s_22_00 <- (1000*9.81*(GL2_v_22_00)^2*(1/38)^2)/((GL2_wd_22_00)^1/3)
GL2_s_25_00 <- (1000*9.81*(GL2_v_25_00)^2*(1/38)^2)/((GL2_wd_25_00)^1/3)
GL2_s_28_00 <- (1000*9.81*(GL2_v_28_00)^2*(1/38)^2)/((GL2_wd_28_00)^1/3)
GL2_s_31_53 <- (1000*9.81*(GL2_v_31_53)^2*(1/38)^2)/((GL2_wd_31_53)^1/3)
```

### L2
```{r}
L2_s_2_40 <- (1000*9.81*(L2_v_2_40)^2*(1/38)^2)/((L2_wd_2_40)^1/3)
L2_s_3_90 <- (1000*9.81*(L2_v_3_90)^2*(1/38)^2)/((L2_wd_3_90)^1/3)
L2_s_7_00 <- (1000*9.81*(L2_v_7_00)^2*(1/38)^2)/((L2_wd_7_00)^1/3)
L2_s_9_24 <- (1000*9.81*(L2_v_9_24)^2*(1/38)^2)/((L2_wd_9_24)^1/3)
L2_s_9_54_ezg <- (1000*9.81*(L2_v_9_54_ezg)^2*(1/38)^2)/((L2_wd_9_54_ezg)^1/3)
L2_s_13_30 <- (1000*9.81*(L2_v_13_30)^2*(1/38)^2)/((L2_wd_13_30)^1/3)
L2_s_16_50 <- (1000*9.81*(L2_v_16_50)^2*(1/38)^2)/((L2_wd_16_50)^1/3)
L2_s_18_90 <- (1000*9.81*(L2_v_18_90)^2*(1/38)^2)/((L2_wd_18_90)^1/3)
```

### M1
```{r}
M1_s_0_47 <- (1000*9.81*(M1_v_0_47)^2*(1/38)^2)/((M1_wd_0_47)^1/3)
M1_s_0_60 <- (1000*9.81*(M1_v_0_60)^2*(1/38)^2)/((M1_wd_0_60)^1/3)
M1_s_1_50_ezg <- (1000*9.81*(M1_v_1_50_ezg)^2*(1/38)^2)/((M1_wd_1_50_ezg)^1/3)
M1_s_4_00 <- (1000*9.81*(M1_v_4_00)^2*(1/38)^2)/((M1_wd_4_00)^1/3)
M1_s_6_00 <- (1000*9.81*(M1_v_6_00)^2*(1/38)^2)/((M1_wd_6_00)^1/3)
M1_s_8_00 <- (1000*9.81*(M1_v_8_00)^2*(1/38)^2)/((M1_wd_8_00)^1/3)
M1_s_10_00 <- (1000*9.81*(M1_v_10_00)^2*(1/38)^2)/((M1_wd_10_00)^1/3)
M1_s_12_00 <- (1000*9.81*(M1_v_12_00)^2*(1/38)^2)/((M1_wd_12_00)^1/3)
M1_s_14_00 <- (1000*9.81*(M1_v_14_00)^2*(1/38)^2)/((M1_wd_14_00)^1/3)
M1_s_16_00 <- (1000*9.81*(M1_v_16_00)^2*(1/38)^2)/((M1_wd_16_00)^1/3)
M1_s_18_84 <- (1000*9.81*(M1_v_18_84)^2*(1/38)^2)/((M1_wd_18_84)^1/3)
M1_s_22_84 <- (1000*9.81*(M1_v_22_84)^2*(1/38)^2)/((M1_wd_22_84)^1/3)
```

### S1
```{r}
S1_s_1_94_ezg <- (1000*9.81*(S1_v_1_94_ezg)^2*(1/38)^2)/((S1_wd_1_94_ezg)^1/3)
S1_s_2_00 <- (1000*9.81*(S1_v_2_00)^2*(1/38)^2)/((S1_wd_2_00)^1/3)
S1_s_3_70 <- (1000*9.81*(S1_v_3_70)^2*(1/38)^2)/((S1_wd_3_70)^1/3)
S1_s_6_50 <- (1000*9.81*(S1_v_6_50)^2*(1/38)^2)/((S1_wd_6_50)^1/3)
S1_s_8_50 <- (1000*9.81*(S1_v_8_50)^2*(1/38)^2)/((S1_wd_8_50)^1/3)
S1_s_10_68 <- (1000*9.81*(S1_v_10_68)^2*(1/38)^2)/((S1_wd_10_68)^1/3)
S1_s_13_00 <- (1000*9.81*(S1_v_13_00)^2*(1/38)^2)/((S1_wd_13_00)^1/3)
S1_s_15_00 <- (1000*9.81*(S1_v_15_00)^2*(1/38)^2)/((S1_wd_15_00)^1/3)
S1_s_18_00 <- (1000*9.81*(S1_v_18_00)^2*(1/38)^2)/((S1_wd_18_00)^1/3)
S1_s_20_00 <- (1000*9.81*(S1_v_20_00)^2*(1/38)^2)/((S1_wd_20_00)^1/3)
```

### S2
```{r}
S2_s_1_93_ezg <- (1000*9.81*(S2_v_1_93_ezg)^2*(1/38)^2)/((S2_wd_1_93_ezg)^1/3)
S2_s_2_00 <- (1000*9.81*(S2_v_2_00)^2*(1/38)^2)/((S2_wd_2_00)^1/3)
S2_s_3_20 <- (1000*9.81*(S2_v_3_20)^2*(1/38)^2)/((S2_wd_3_20)^1/3)
S2_s_6_50 <- (1000*9.81*(S2_v_6_50)^2*(1/38)^2)/((S2_wd_6_50)^1/3)
S2_s_8_50 <- (1000*9.81*(S2_v_8_50)^2*(1/38)^2)/((S2_wd_8_50)^1/3)
S2_s_10_93 <- (1000*9.81*(S2_v_10_93)^2*(1/38)^2)/((S2_wd_10_93)^1/3)
S2_s_13_00 <- (1000*9.81*(S2_v_13_00)^2*(1/38)^2)/((S2_wd_13_00)^1/3)
S2_s_15_00 <- (1000*9.81*(S2_v_15_00)^2*(1/38)^2)/((S2_wd_15_00)^1/3)
S2_s_18_00 <- (1000*9.81*(S2_v_18_00)^2*(1/38)^2)/((S2_wd_18_00)^1/3)
S2_s_20_00 <- (1000*9.81*(S2_v_20_00)^2*(1/38)^2)/((S2_wd_20_00)^1/3)
```

### TH4
```{r}
TH4_s_11_45 <- (1000*9.81*(TH4_v_11_45)^2*(1/38)^2)/((TH4_wd_11_45)^1/3)
TH4_s_15_00 <- (1000*9.81*(TH4_v_15_00)^2*(1/38)^2)/((TH4_wd_15_00)^1/3)
TH4_s_18_00 <- (1000*9.81*(TH4_v_18_00)^2*(1/38)^2)/((TH4_wd_18_00)^1/3)
TH4_s_19_96 <- (1000*9.81*(TH4_v_19_96)^2*(1/38)^2)/((TH4_wd_19_96)^1/3)
TH4_s_22_50 <- (1000*9.81*(TH4_v_22_50)^2*(1/38)^2)/((TH4_wd_22_50)^1/3)
TH4_s_25_00 <- (1000*9.81*(TH4_v_25_00)^2*(1/38)^2)/((TH4_wd_25_00)^1/3)
TH4_s_27_00 <- (1000*9.81*(TH4_v_27_00)^2*(1/38)^2)/((TH4_wd_27_00)^1/3)
TH4_s_30_00 <- (1000*9.81*(TH4_v_30_00)^2*(1/38)^2)/((TH4_wd_30_00)^1/3)
TH4_s_32_93 <- (1000*9.81*(TH4_v_32_93)^2*(1/38)^2)/((TH4_wd_32_93)^1/3)
TH4_s_35_12_ezg <- (1000*9.81*(TH4_v_35_12_ezg)^2*(1/38)^2)/((TH4_wd_35_12_ezg)^1/3)
```

### VR3
```{r}
VR3_s_2_90 <- (1000*9.81*(VR3_v_2_90)^2*(1/38)^2)/((VR3_wd_2_90)^1/3)
VR3_s_6_00 <- (1000*9.81*(VR3_v_6_00)^2*(1/38)^2)/((VR3_wd_6_00)^1/3)
VR3_s_9_00 <- (1000*9.81*(VR3_v_9_00)^2*(1/38)^2)/((VR3_wd_9_00)^1/3)
VR3_s_12_00 <- (1000*9.81*(VR3_v_12_00)^2*(1/38)^2)/((VR3_wd_12_00)^1/3)
VR3_s_15_00 <- (1000*9.81*(VR3_v_15_00)^2*(1/38)^2)/((VR3_wd_15_00)^1/3)
VR3_s_18_80 <- (1000*9.81*(VR3_v_18_80)^2*(1/38)^2)/((VR3_wd_18_80)^1/3)
VR3_s_21_51_ezg <- (1000*9.81*(VR3_v_21_51_ezg)^2*(1/38)^2)/((VR3_wd_21_51_ezg)^1/3)
VR3_s_22_00 <- (1000*9.81*(VR3_v_22_00)^2*(1/38)^2)/((VR3_wd_22_00)^1/3)
VR3_s_25_00 <- (1000*9.81*(VR3_v_25_00)^2*(1/38)^2)/((VR3_wd_25_00)^1/3)
VR3_s_28_00 <- (1000*9.81*(VR3_v_28_00)^2*(1/38)^2)/((VR3_wd_28_00)^1/3)
VR3_s_31_00 <- (1000*9.81*(VR3_v_31_00)^2*(1/38)^2)/((VR3_wd_31_00)^1/3)
VR3_s_34_00 <- (1000*9.81*(VR3_v_34_00)^2*(1/38)^2)/((VR3_wd_34_00)^1/3)
VR3_s_37_00 <- (1000*9.81*(VR3_v_37_00)^2*(1/38)^2)/((VR3_wd_37_00)^1/3)
VR3_s_40_10 <- (1000*9.81*(VR3_v_40_10)^2*(1/38)^2)/((VR3_wd_40_10)^1/3)
VR3_s_43_00 <- (1000*9.81*(VR3_v_43_00)^2*(1/38)^2)/((VR3_wd_43_00)^1/3)
VR3_s_46_00 <- (1000*9.81*(VR3_v_46_00)^2*(1/38)^2)/((VR3_wd_46_00)^1/3)
VR3_s_48_00 <- (1000*9.81*(VR3_v_48_00)^2*(1/38)^2)/((VR3_wd_48_00)^1/3)
VR3_s_50_00 <- (1000*9.81*(VR3_v_50_00)^2*(1/38)^2)/((VR3_wd_50_00)^1/3)
VR3_s_52_90 <- (1000*9.81*(VR3_v_52_90)^2*(1/38)^2)/((VR3_wd_52_90)^1/3)
```

### Dataframe
```{r}
# calculate from dataframe for ML models
data_wd_s <- (1000*9.81*(data_wd$velocity)^2*(1/38)^2)/((data_wd$wd_m)^1/3)
```

## Stream Power
### GL1
```{r}
GL1_sp_2_56_ezg <- abs(GL1_v_2_56_ezg)*GL1_s_2_56_ezg
GL1_sp_3_28 <- abs(GL1_v_3_28)*GL1_s_3_28
GL1_sp_6_00 <- abs(GL1_v_6_00)*GL1_s_6_00
GL1_sp_9_00 <- abs(GL1_v_9_00)*GL1_s_9_00
GL1_sp_12_68 <- abs(GL1_v_12_68)*GL1_s_12_68
GL1_sp_16_00 <- abs(GL1_v_16_00)*GL1_s_16_00
GL1_sp_19_00 <- abs(GL1_v_19_00)*GL1_s_19_00
GL1_sp_22_00 <- abs(GL1_v_22_00)*GL1_s_22_00
GL1_sp_25_00 <- abs(GL1_v_25_00)*GL1_s_25_00
GL1_sp_28_00 <- abs(GL1_v_28_00)*GL1_s_28_00
GL1_sp_31_76 <- abs(GL1_v_31_76)*GL1_s_31_76
```

### GL2
```{r}
GL2_sp_2_37_ezg <- abs(GL2_v_2_37_ezg)*GL2_s_2_37_ezg
GL2_sp_3_21 <- abs(GL2_v_3_21)*GL2_s_3_21
GL2_sp_6_00 <- abs(GL2_v_6_00)*GL2_s_6_00
GL2_sp_9_00 <- abs(GL2_v_9_00)*GL2_s_9_00
GL2_sp_11_00 <- abs(GL2_v_11_00)*GL2_s_11_00
GL2_sp_12_52 <- abs(GL2_v_12_52)*GL2_s_12_52
GL2_sp_16_00 <- abs(GL2_v_16_00)*GL2_s_16_00
GL2_sp_19_00 <- abs(GL2_v_19_00)*GL2_s_19_00
GL2_sp_22_00 <- abs(GL2_v_22_00)*GL2_s_22_00
GL2_sp_25_00 <- abs(GL2_v_25_00)*GL2_s_25_00
GL2_sp_28_00 <- abs(GL2_v_28_00)*GL2_s_28_00
GL2_sp_31_53 <- abs(GL2_v_31_53)*GL2_s_31_53
```

### L2
```{r}
L2_sp_2_40 <- abs(L2_v_2_40)*L2_s_2_40
L2_sp_3_90 <- abs(L2_v_3_90)*L2_s_3_90
L2_sp_7_00 <- abs(L2_v_7_00)*L2_s_7_00
L2_sp_9_24 <- abs(L2_v_9_24)*L2_s_9_24
L2_sp_9_54_ezg <- abs(L2_v_9_54_ezg)*L2_s_9_54_ezg
L2_sp_13_30 <- abs(L2_v_13_30)*L2_s_13_30
L2_sp_16_50 <- abs(L2_v_16_50)*L2_s_16_50
L2_sp_18_90 <- abs(L2_v_18_90)*L2_s_18_90
```

### M1
```{r}
M1_sp_0_47 <- abs(M1_v_0_47)*M1_s_0_47
M1_sp_0_60 <- abs(M1_v_0_60)*M1_s_0_60
M1_sp_1_50_ezg <- abs(M1_v_1_50_ezg)*M1_s_1_50_ezg
M1_sp_4_00 <- abs(M1_v_4_00)*M1_s_4_00
M1_sp_6_00 <- abs(M1_v_6_00)*M1_s_6_00
M1_sp_8_00 <- abs(M1_v_8_00)*M1_s_8_00
M1_sp_10_00 <- abs(M1_v_10_00)*M1_s_10_00
M1_sp_12_00 <- abs(M1_v_12_00)*M1_s_12_00
M1_sp_14_00 <- abs(M1_v_14_00)*M1_s_14_00
M1_sp_16_00 <- abs(M1_v_16_00)*M1_s_16_00
M1_sp_18_84 <- abs(M1_v_18_84)*M1_s_18_84
M1_sp_22_84 <- abs(M1_v_22_84)*M1_s_22_84
```

### S1
```{r}
S1_sp_1_94_ezg <- abs(S1_v_1_94_ezg)*S1_s_1_94_ezg
S1_sp_2_00 <- abs(S1_v_2_00)*S1_s_2_00
S1_sp_3_70 <- abs(S1_v_3_70)*S1_s_3_70
S1_sp_6_50 <- abs(S1_v_6_50)*S1_s_6_50
S1_sp_8_50 <- abs(S1_v_8_50)*S1_s_8_50
S1_sp_10_68 <- abs(S1_v_10_68)*S1_s_10_68
S1_sp_13_00 <- abs(S1_v_13_00)*S1_s_13_00
S1_sp_15_00 <- abs(S1_v_15_00)*S1_s_15_00
S1_sp_18_00 <- abs(S1_v_18_00)*S1_s_18_00
S1_sp_20_00 <- abs(S1_v_20_00)*S1_s_20_00
```

### S2
```{r}
S2_sp_1_93_ezg <- abs(S2_v_1_93_ezg)*S2_s_1_93_ezg
S2_sp_2_00 <- abs(S2_v_2_00)*S2_s_2_00
S2_sp_3_20 <- abs(S2_v_3_20)*S2_s_3_20
S2_sp_6_50 <- abs(S2_v_6_50)*S2_s_6_50
S2_sp_8_50 <- abs(S2_v_8_50)*S2_s_8_50
S2_sp_10_93 <- abs(S2_v_10_93)*S2_s_10_93
S2_sp_13_00 <- abs(S2_v_13_00)*S2_s_13_00
S2_sp_15_00 <- abs(S2_v_15_00)*S2_s_15_00
S2_sp_18_00 <- abs(S2_v_18_00)*S2_s_18_00
S2_sp_20_00 <- abs(S2_v_20_00)*S2_s_20_00
```

### TH4
```{r}
TH4_sp_11_45 <- abs(TH4_v_11_45)*TH4_s_11_45
TH4_sp_15_00 <- abs(TH4_v_15_00)*TH4_s_15_00
TH4_sp_18_00 <- abs(TH4_v_18_00)*TH4_s_18_00
TH4_sp_19_96 <- abs(TH4_v_19_96)*TH4_s_19_96
TH4_sp_22_50 <- abs(TH4_v_22_50)*TH4_s_22_50
TH4_sp_25_00 <- abs(TH4_v_25_00)*TH4_s_25_00
TH4_sp_27_00 <- abs(TH4_v_27_00)*TH4_s_27_00
TH4_sp_30_00 <- abs(TH4_v_30_00)*TH4_s_30_00
TH4_sp_32_93 <- abs(TH4_v_32_93)*TH4_s_32_93
TH4_sp_35_12_ezg <- abs(TH4_v_35_12_ezg)*TH4_s_35_12_ezg
```

### VR3
```{r}
VR3_sp_2_90 <- abs(VR3_v_2_90)*VR3_s_2_90
VR3_sp_6_00 <- abs(VR3_v_6_00)*VR3_s_6_00
VR3_sp_9_00 <- abs(VR3_v_9_00)*VR3_s_9_00
VR3_sp_12_00 <- abs(VR3_v_12_00)*VR3_s_12_00
VR3_sp_15_00 <- abs(VR3_v_15_00)*VR3_s_15_00
VR3_sp_18_80 <- abs(VR3_v_18_80)*VR3_s_18_80
VR3_sp_21_51_ezg <- abs(VR3_v_21_51_ezg)*VR3_s_21_51_ezg
VR3_sp_22_00 <- abs(VR3_v_22_00)*VR3_s_22_00
VR3_sp_25_00 <- abs(VR3_v_25_00)*VR3_s_25_00
VR3_sp_28_00 <- abs(VR3_v_28_00)*VR3_s_28_00
VR3_sp_31_00 <- abs(VR3_v_31_00)*VR3_s_31_00
VR3_sp_34_00 <- abs(VR3_v_34_00)*VR3_s_34_00
VR3_sp_37_00 <- abs(VR3_v_37_00)*VR3_s_37_00
VR3_sp_40_10 <- abs(VR3_v_40_10)*VR3_s_40_10
VR3_sp_43_00 <- abs(VR3_v_43_00)*VR3_s_43_00
VR3_sp_46_00 <- abs(VR3_v_46_00)*VR3_s_46_00
VR3_sp_48_00 <- abs(VR3_v_48_00)*VR3_s_48_00
VR3_sp_50_00 <- abs(VR3_v_50_00)*VR3_s_50_00
VR3_sp_52_90 <- abs(VR3_v_52_90)*VR3_s_52_90
```

### Dataframe
```{r}
# calculate from dataframe for ML models
data_wd_sp <- abs(data_wd$velocity)*data_wd_s
```


# Stack rasters 
## GL1
```{r}
GL1_2_56_ezg <- stack(GL1_v_2_56_ezg, GL1_wd_2_56_ezg, GL1_f_2_56_ezg, GL1_s_2_56_ezg, GL1_sp_2_56_ezg) 
names(GL1_2_56_ezg) <- c("GL1_v_2_56_ezg", "GL1_wd_2_56_ezg", "GL1_f_2_56_ezg", "GL1_s_2_56_ezg", "GL1_sp_2_56_ezg") 

GL1_3_28 <- stack(GL1_v_3_28, GL1_wd_3_28, GL1_f_3_28, GL1_s_3_28, GL1_sp_3_28)
names(GL1_3_28) <- c("GL1_v_3_28", "GL1_wd_3_28", "GL1_f_3_28", "GL1_s_3_28", "GL1_sp_3_28") 

GL1_6_00 <- stack(GL1_v_6_00, GL1_wd_6_00, GL1_f_6_00, GL1_s_6_00, GL1_sp_6_00)
names(GL1_6_00) <- c("GL1_v_6_00", "GL1_wd_6_00", "GL1_f_6_00", "GL1_s_6_00", "GL1_sp_6_00") 

GL1_9_00 <- stack(GL1_v_9_00, GL1_wd_9_00, GL1_f_9_00, GL1_s_9_00, GL1_sp_9_00)
names(GL1_9_00) <- c("GL1_v_9_00", "GL1_wd_9_00", "GL1_f_9_00", "GL1_s_9_00", "GL1_sp_9_00")

GL1_12_68 <- stack(GL1_v_12_68, GL1_wd_12_68, GL1_f_12_68, GL1_s_12_68, GL1_sp_12_68)
names(GL1_12_68) <- c("GL1_v_12_68", "GL1_wd_12_68", "GL1_f_12_68", "GL1_s_12_68", "GL1_sp_12_68")

GL1_16_00 <- stack(GL1_v_16_00, GL1_wd_16_00, GL1_f_16_00, GL1_s_16_00, GL1_sp_16_00)
names(GL1_16_00) <- c("GL1_v_16_00", "GL1_wd_16_00", "GL1_f_16_00", "GL1_s_16_00", "GL1_sp_16_00")

GL1_19_00 <- stack(GL1_v_19_00, GL1_wd_19_00, GL1_f_19_00, GL1_s_19_00, GL1_sp_19_00)
names(GL1_19_00) <- c("GL1_v_19_00", "GL1_wd_19_00", "GL1_f_19_00", "GL1_s_19_00", "GL1_sp_19_00")

GL1_22_00 <- stack(GL1_v_22_00, GL1_wd_22_00, GL1_f_22_00, GL1_s_22_00, GL1_sp_22_00)
names(GL1_22_00) <- c("GL1_v_22_00", "GL1_wd_22_00", "GL1_f_22_00", "GL1_s_22_00", "GL1_sp_22_00")

GL1_25_00 <- stack(GL1_v_25_00, GL1_wd_25_00, GL1_f_25_00, GL1_s_25_00, GL1_sp_25_00)
names(GL1_25_00) <- c("GL1_v_25_00", "GL1_wd_25_00", "GL1_f_25_00", "GL1_s_25_00", "GL1_sp_25_00")

GL1_28_00 <- stack(GL1_v_28_00, GL1_wd_28_00, GL1_f_28_00, GL1_s_28_00, GL1_sp_28_00)
names(GL1_28_00) <- c("GL1_v_28_00", "GL1_wd_28_00", "GL1_f_28_00", "GL1_s_28_00", "GL1_sp_28_00")

GL1_31_76 <- stack(GL1_v_31_76, GL1_wd_31_76, GL1_f_31_76, GL1_s_31_76, GL1_sp_31_76)
names(GL1_31_76) <- c("GL1_v_31_76", "GL1_wd_31_76", "GL1_f_31_76", "GL1_s_31_76", "GL1_sp_31_76")
```

## GL2
```{r}
GL2_2_37_ezg <- stack(GL2_v_2_37_ezg, GL2_wd_2_37_ezg, GL2_f_2_37_ezg, GL2_s_2_37_ezg, GL2_sp_2_37_ezg) 
names(GL2_2_37_ezg) <- c("GL2_v_2_37_ezg", "GL2_wd_2_37_ezg", "GL2_f_2_37_ezg", "GL2_s_2_37_ezg", "GL2_sp_2_37_ezg") 

GL2_3_21 <- stack(GL2_v_3_21, GL2_wd_3_21, GL2_f_3_21, GL2_s_3_21, GL2_sp_3_21) 
names(GL2_3_21) <- c("GL2_v_3_21", "GL2_wd_3_21", "GL2_f_3_21", "GL2_s_3_21", "GL2_sp_3_21") 

GL2_6_00 <- stack(GL2_v_6_00, GL2_wd_6_00, GL2_f_6_00, GL2_s_6_00, GL2_sp_6_00) 
names(GL2_6_00) <- c("GL2_v_6_00", "GL2_wd_6_00", "GL2_f_6_00", "GL2_s_6_00", "GL2_sp_6_00")

GL2_9_00 <- stack(GL2_v_9_00, GL2_wd_9_00, GL2_f_9_00, GL2_s_9_00, GL2_sp_9_00) 
names(GL2_9_00) <- c("GL2_v_9_00", "GL2_wd_9_00", "GL2_f_9_00", "GL2_s_9_00", "GL2_sp_9_00") 

GL2_11_00 <- stack(GL2_v_11_00, GL2_wd_11_00, GL2_f_11_00, GL2_s_11_00, GL2_sp_11_00) 
names(GL2_11_00) <- c("GL2_v_11_00", "GL2_wd_11_00", "GL2_f_11_00", "GL2_s_11_00", "GL2_sp_11_00") 

GL2_12_52 <- stack(GL2_v_12_52, GL2_wd_12_52, GL2_f_12_52, GL2_s_12_52, GL2_sp_12_52) 
names(GL2_12_52) <- c("GL2_v_12_52", "GL2_wd_12_52", "GL2_f_12_52", "GL2_s_12_52", "GL2_sp_12_52") 

GL2_16_00 <- stack(GL2_v_16_00, GL2_wd_16_00, GL2_f_16_00, GL2_s_16_00, GL2_sp_16_00) 
names(GL2_16_00) <- c("GL2_v_16_00", "GL2_wd_16_00", "GL2_f_16_00", "GL2_s_16_00", "GL2_sp_16_00") 

GL2_19_00 <- stack(GL2_v_19_00, GL2_wd_19_00, GL2_f_19_00, GL2_s_19_00, GL2_sp_19_00) 
names(GL2_19_00) <- c("GL2_v_19_00", "GL2_wd_19_00", "GL2_f_19_00", "GL2_s_19_00", "GL2_sp_19_00") 

GL2_22_00 <- stack(GL2_v_22_00, GL2_wd_22_00, GL2_f_22_00, GL2_s_22_00, GL2_sp_22_00) 
names(GL2_22_00) <- c("GL2_v_22_00", "GL2_wd_22_00", "GL2_f_22_00", "GL2_s_22_00", "GL2_sp_22_00") 

GL2_25_00 <- stack(GL2_v_25_00, GL2_wd_25_00, GL2_f_25_00, GL2_s_25_00, GL2_sp_25_00) 
names(GL2_25_00) <- c("GL2_v_25_00", "GL2_wd_25_00", "GL2_f_25_00", "GL2_s_25_00", "GL2_sp_25_00") 

GL2_28_00 <- stack(GL2_v_28_00, GL2_wd_28_00, GL2_f_28_00, GL2_s_28_00, GL2_sp_28_00) 
names(GL2_28_00) <- c("GL2_v_28_00", "GL2_wd_28_00", "GL2_f_28_00", "GL2_s_28_00", "GL2_sp_28_00") 

GL2_31_53 <- stack(GL2_v_31_53, GL2_wd_31_53, GL2_f_31_53, GL2_s_31_53, GL2_sp_31_53) 
names(GL2_31_53) <- c("GL2_v_31_53", "GL2_wd_31_53", "GL2_f_31_53", "GL2_s_31_53", "GL2_sp_31_53") 
```

## L2
```{r}
L2_2_40 <- stack(L2_v_2_40, L2_wd_2_40, L2_f_2_40, L2_s_2_40, L2_sp_2_40) 
names(L2_2_40) <- c("L2_v_2_40", "L2_wd_2_40", "L2_f_2_40", "L2_s_2_40", "L2_sp_2_40")

L2_3_90 <- stack(L2_v_3_90, L2_wd_3_90, L2_f_3_90, L2_s_3_90, L2_sp_3_90) 
names(L2_3_90) <- c("L2_v_3_90", "L2_wd_3_90", "L2_f_3_90", "L2_s_3_90", "L2_sp_3_90")

L2_7_00 <- stack(L2_v_7_00, L2_wd_7_00, L2_f_7_00, L2_s_7_00, L2_sp_7_00) 
names(L2_7_00) <- c("L2_v_7_00", "L2_wd_7_00", "L2_f_7_00", "L2_s_7_00", "L2_sp_7_00")

L2_9_24 <- stack(L2_v_9_24, L2_wd_9_24, L2_f_9_24, L2_s_9_24, L2_sp_9_24) 
names(L2_9_24) <- c("L2_v_9_24", "L2_wd_9_24", "L2_f_9_24", "L2_s_9_24", "L2_sp_9_24")

L2_9_54_ezg <- stack(L2_v_9_54_ezg, L2_wd_9_54_ezg, L2_f_9_54_ezg, L2_s_9_54_ezg, L2_sp_9_54_ezg) 
names(L2_9_54_ezg) <- c("L2_v_9_54_ezg", "L2_wd_9_54_ezg", "L2_f_9_54_ezg", "L2_s_9_54_ezg", "L2_sp_9_54_ezg")

L2_13_30 <- stack(L2_v_13_30, L2_wd_13_30, L2_f_13_30, L2_s_13_30, L2_sp_13_30) 
names(L2_13_30) <- c("L2_v_13_30", "L2_wd_13_30", "L2_f_13_30", "L2_s_13_30", "L2_sp_13_30")

L2_16_50 <- stack(L2_v_16_50, L2_wd_16_50, L2_f_16_50, L2_s_16_50, L2_sp_16_50) 
names(L2_16_50) <- c("L2_v_16_50", "L2_wd_16_50", "L2_f_16_50", "L2_s_16_50", "L2_sp_16_50")

L2_18_90 <- stack(L2_v_18_90, L2_wd_18_90, L2_f_18_90, L2_s_18_90, L2_sp_18_90) 
names(L2_18_90) <- c("L2_v_18_90", "L2_wd_18_90", "L2_f_18_90", "L2_s_18_90", "L2_sp_18_90")
```

## M1 
```{r}
M1_0_47 <- stack(M1_v_0_47, M1_wd_0_47, M1_f_0_47, M1_s_0_47, M1_sp_0_47) 
names(M1_0_47) <- c("M1_v_0_47", "M1_wd_0_47", "M1_f_0_47", "M1_s_0_47", "M1_sp_0_47")

M1_0_60 <- stack(M1_v_0_60, M1_wd_0_60, M1_f_0_60, M1_s_0_60, M1_sp_0_60) 
names(M1_0_60) <- c("M1_v_0_60", "M1_wd_0_60", "M1_f_0_60", "M1_s_0_60", "M1_sp_0_60")

M1_1_50_ezg <- stack(M1_v_1_50_ezg, M1_wd_1_50_ezg, M1_f_1_50_ezg, M1_s_1_50_ezg, M1_sp_1_50_ezg) 
names(M1_1_50_ezg) <- c("M1_v_1_50_ezg", "M1_wd_1_50_ezg", "M1_f_1_50_ezg", "M1_s_1_50_ezg", "M1_sp_1_50_ezg")

M1_4_00 <- stack(M1_v_4_00, M1_wd_4_00, M1_f_4_00, M1_s_4_00, M1_sp_4_00) 
names(M1_4_00) <- c("M1_v_4_00", "M1_wd_4_00", "M1_f_4_00", "M1_s_4_00", "M1_sp_4_00")

M1_6_00 <- stack(M1_v_6_00, M1_wd_6_00, M1_f_6_00, M1_s_6_00, M1_sp_6_00) 
names(M1_6_00) <- c("M1_v_6_00", "M1_wd_6_00", "M1_f_6_00", "M1_s_6_00", "M1_sp_6_00")

M1_8_00 <- stack(M1_v_8_00, M1_wd_8_00, M1_f_8_00, M1_s_8_00, M1_sp_8_00) 
names(M1_8_00) <- c("M1_v_8_00", "M1_wd_8_00", "M1_f_8_00", "M1_s_8_00", "M1_sp_8_00")

M1_10_00 <- stack(M1_v_10_00, M1_wd_10_00, M1_f_10_00, M1_s_10_00, M1_sp_10_00) 
names(M1_10_00) <- c("M1_v_10_00", "M1_wd_10_00", "M1_f_10_00", "M1_s_10_00", "M1_sp_10_00")

M1_12_00 <- stack(M1_v_12_00, M1_wd_12_00, M1_f_12_00, M1_s_12_00, M1_sp_12_00) 
names(M1_12_00) <- c("M1_v_12_00", "M1_wd_12_00", "M1_f_12_00", "M1_s_12_00", "M1_sp_12_00")

M1_14_00 <- stack(M1_v_14_00, M1_wd_14_00, M1_f_14_00, M1_s_14_00, M1_sp_14_00) 
names(M1_14_00) <- c("M1_v_14_00", "M1_wd_14_00", "M1_f_14_00", "M1_s_14_00", "M1_sp_14_00")

M1_16_00 <- stack(M1_v_16_00, M1_wd_16_00, M1_f_16_00, M1_s_16_00, M1_sp_16_00) 
names(M1_16_00) <- c("M1_v_16_00", "M1_wd_16_00", "M1_f_16_00", "M1_s_16_00", "M1_sp_16_00")

M1_18_84 <- stack(M1_v_18_84, M1_wd_18_84, M1_f_18_84, M1_s_18_84, M1_sp_18_84) 
names(M1_18_84) <- c("M1_v_18_84", "M1_wd_18_84", "M1_f_18_84", "M1_s_18_84", "M1_sp_18_84")

M1_22_84 <- stack(M1_v_22_84, M1_wd_22_84, M1_f_22_84, M1_s_22_84, M1_sp_22_84) 
names(M1_22_84) <- c("M1_v_22_84", "M1_wd_22_84", "M1_f_22_84", "M1_s_22_84", "M1_sp_22_84")
```

## S1
```{r}
M1_22_84 <- stack(M1_v_22_84, M1_wd_22_84, M1_f_22_84, M1_s_22_84, M1_sp_22_84) 
names(M1_22_84) <- c("M1_v_22_84", "M1_wd_22_84", "M1_f_22_84", "M1_s_22_84", "M1_sp_22_84")
```
S1_f_1_94_ezg <- S1_v_1_94_ezg/(sqrt(9.81 * S1_wd_1_94_ezg))
S1_f_2_00 <- S1_v_2_00/(sqrt(9.81 * S1_wd_2_00))
S1_f_3_70 <- S1_v_3_70/(sqrt(9.81 * S1_wd_3_70))
S1_f_6_50 <- S1_v_6_50/(sqrt(9.81 * S1_wd_6_50))
S1_f_8_50 <- S1_v_8_50/(sqrt(9.81 * S1_wd_8_50))
S1_f_10_68 <- S1_v_10_68/(sqrt(9.81 * S1_wd_10_68))
S1_f_13_00 <- S1_v_13_00/(sqrt(9.81 * S1_wd_13_00))
S1_f_15_00 <- S1_v_15_00/(sqrt(9.81 * S1_wd_15_00))
S1_f_18_00 <- S1_v_18_00/(sqrt(9.81 * S1_wd_18_00))
S1_f_20_00 <- S1_v_20_00/(sqrt(9.81 * S1_wd_20_00))

# Save rasters
## GL1
```{r}
# Single attribute rasters
## GL1
writeRaster(GL1_f_2_56_ezg, "Pre_Processing/raster_files/GL1_f_2_56_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_2_56_ezg, "Pre_Processing/raster_files/GL1_s_2_56_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_2_56_ezg, "Pre_Processing/raster_files/GL1_sp_2_56_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_2_56_ezg, "Pre_Processing/rasters_stacked/GL1_2_56_ezg_add.grd", overwrite = TRUE)

writeRaster(GL1_f_3_28, "Pre_Processing/raster_files/GL1_f_3_28.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_3_28, "Pre_Processing/raster_files/GL1_s_3_28.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_3_28, "Pre_Processing/raster_files/GL1_sp_3_28.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_3_28, "Pre_Processing/rasters_stacked/GL1_3_28_add.grd", overwrite = TRUE)

writeRaster(GL1_f_6_00, "Pre_Processing/raster_files/GL1_f_6_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_6_00, "Pre_Processing/raster_files/GL1_s_6_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_6_00, "Pre_Processing/raster_files/GL1_sp_6_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_6_00, "Pre_Processing/rasters_stacked/GL1_6_00_add.grd", overwrite = TRUE)

writeRaster(GL1_f_9_00, "Pre_Processing/raster_files/GL1_f_9_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_9_00, "Pre_Processing/raster_files/GL1_s_9_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_9_00, "Pre_Processing/raster_files/GL1_sp_9_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_9_00, "Pre_Processing/rasters_stacked/GL1_9_00_add.grd", overwrite = TRUE)

writeRaster(GL1_f_12_68, "Pre_Processing/raster_files/GL1_f_12_68.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_12_68, "Pre_Processing/raster_files/GL1_s_12_68.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_12_68, "Pre_Processing/raster_files/GL1_sp_12_68.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_12_68, "Pre_Processing/rasters_stacked/GL1_12_68_add.grd", overwrite = TRUE)

writeRaster(GL1_f_16_00, "Pre_Processing/raster_files/GL1_f_16_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_16_00, "Pre_Processing/raster_files/GL1_s_16_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_16_00, "Pre_Processing/raster_files/GL1_sp_16_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_16_00, "Pre_Processing/rasters_stacked/GL1_16_00_add.grd", overwrite = TRUE)

writeRaster(GL1_f_19_00, "Pre_Processing/raster_files/GL1_f_19_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_19_00, "Pre_Processing/raster_files/GL1_s_19_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_19_00, "Pre_Processing/raster_files/GL1_sp_19_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_19_00, "Pre_Processing/rasters_stacked/GL1_19_00_add.grd", overwrite = TRUE)

writeRaster(GL1_f_22_00, "Pre_Processing/raster_files/GL1_f_22_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_22_00, "Pre_Processing/raster_files/GL1_s_22_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_22_00, "Pre_Processing/raster_files/GL1_sp_22_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_22_00, "Pre_Processing/rasters_stacked/GL1_22_00_add.grd", overwrite = TRUE)

writeRaster(GL1_f_25_00, "Pre_Processing/raster_files/GL1_f_25_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_25_00, "Pre_Processing/raster_files/GL1_s_25_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_25_00, "Pre_Processing/raster_files/GL1_sp_25_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_25_00, "Pre_Processing/rasters_stacked/GL1_25_00_add.grd", overwrite = TRUE)

writeRaster(GL1_f_28_00, "Pre_Processing/raster_files/GL1_f_28_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_28_00, "Pre_Processing/raster_files/GL1_s_28_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_28_00, "Pre_Processing/raster_files/GL1_sp_28_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_28_00, "Pre_Processing/rasters_stacked/GL1_28_00_add.grd", overwrite = TRUE)

writeRaster(GL1_f_31_76, "Pre_Processing/raster_files/GL1_f_31_76.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_s_31_76, "Pre_Processing/raster_files/GL1_s_31_76.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_sp_31_76, "Pre_Processing/raster_files/GL1_sp_31_76.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL1_31_76, "Pre_Processing/rasters_stacked/GL1_31_76_add.grd", overwrite = TRUE)
```

## GL2
```{r}
writeRaster(GL2_f_2_37_ezg, "Pre_Processing/raster_files/GL2_f_2_37_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_2_37_ezg, "Pre_Processing/raster_files/GL2_s_2_37_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_2_37_ezg, "Pre_Processing/raster_files/GL2_sp_2_37_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_2_37_ezg, "Pre_Processing/rasters_stacked/GL2_2_37_ezg_add.grd", overwrite = TRUE)

writeRaster(GL2_f_3_21, "Pre_Processing/raster_files/GL2_f_3_21.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_3_21, "Pre_Processing/raster_files/GL2_s_3_21.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_3_21, "Pre_Processing/raster_files/GL2_sp_3_21.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_3_21, "Pre_Processing/rasters_stacked/GL2_3_21_add.grd", overwrite = TRUE)

writeRaster(GL2_f_6_00, "Pre_Processing/raster_files/GL2_f_6_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_6_00, "Pre_Processing/raster_files/GL2_s_6_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_6_00, "Pre_Processing/raster_files/GL2_sp_6_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_6_00, "Pre_Processing/rasters_stacked/GL2_6_00_add.grd", overwrite = TRUE)

writeRaster(GL2_f_9_00, "Pre_Processing/raster_files/GL2_f_9_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_9_00, "Pre_Processing/raster_files/GL2_s_9_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_9_00, "Pre_Processing/raster_files/GL2_sp_9_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_9_00, "Pre_Processing/rasters_stacked/GL2_9_00_add.grd", overwrite = TRUE)

writeRaster(GL2_f_11_00, "Pre_Processing/raster_files/GL2_f_11_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_11_00, "Pre_Processing/raster_files/GL2_s_11_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_11_00, "Pre_Processing/raster_files/GL2_sp_11_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_11_00, "Pre_Processing/rasters_stacked/GL2_11_00_add.grd", overwrite = TRUE)

writeRaster(GL2_f_12_52, "Pre_Processing/raster_files/GL2_f_12_52.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_12_52, "Pre_Processing/raster_files/GL2_s_12_52.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_12_52, "Pre_Processing/raster_files/GL2_sp_12_52.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_12_52, "Pre_Processing/rasters_stacked/GL2_12_52_add.grd", overwrite = TRUE)

writeRaster(GL2_f_16_00, "Pre_Processing/raster_files/GL2_f_16_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_16_00, "Pre_Processing/raster_files/GL2_s_16_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_16_00, "Pre_Processing/raster_files/GL2_sp_16_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_16_00, "Pre_Processing/rasters_stacked/GL2_16_00_add.grd", overwrite = TRUE)

writeRaster(GL2_f_19_00, "Pre_Processing/raster_files/GL2_f_19_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_19_00, "Pre_Processing/raster_files/GL2_s_19_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_19_00, "Pre_Processing/raster_files/GL2_sp_19_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_19_00, "Pre_Processing/rasters_stacked/GL2_19_00_add.grd", overwrite = TRUE)

writeRaster(GL2_f_22_00, "Pre_Processing/raster_files/GL2_f_22_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_22_00, "Pre_Processing/raster_files/GL2_s_22_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_22_00, "Pre_Processing/raster_files/GL2_sp_22_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_22_00, "Pre_Processing/rasters_stacked/GL2_22_00_add.grd", overwrite = TRUE)

writeRaster(GL2_f_25_00, "Pre_Processing/raster_files/GL2_f_25_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_25_00, "Pre_Processing/raster_files/GL2_s_25_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_25_00, "Pre_Processing/raster_files/GL2_sp_25_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_25_00, "Pre_Processing/rasters_stacked/GL2_25_00_add.grd", overwrite = TRUE)

writeRaster(GL2_f_28_00, "Pre_Processing/raster_files/GL2_f_28_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_28_00, "Pre_Processing/raster_files/GL2_s_28_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_28_00, "Pre_Processing/raster_files/GL2_sp_28_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_28_00, "Pre_Processing/rasters_stacked/GL2_28_00_add.grd", overwrite = TRUE)

writeRaster(GL2_f_31_53, "Pre_Processing/raster_files/GL2_f_31_53.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_s_31_53, "Pre_Processing/raster_files/GL2_s_31_53.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_sp_31_53, "Pre_Processing/raster_files/GL2_sp_31_53.tif", format = "GTiff", overwrite = TRUE)
writeRaster(GL2_31_53, "Pre_Processing/rasters_stacked/GL2_31_53_add.grd", overwrite = TRUE)
```

## L2
```{r}
writeRaster(L2_f_2_40, "Pre_Processing/raster_files/L2_f_2_40.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_s_2_40, "Pre_Processing/raster_files/L2_s_2_40.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_sp_2_40, "Pre_Processing/raster_files/L2_sp_2_40.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_2_40, "Pre_Processing/rasters_stacked/L2_2_40_add.grd", overwrite = TRUE)

writeRaster(L2_f_3_90, "Pre_Processing/raster_files/L2_f_3_90.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_s_3_90, "Pre_Processing/raster_files/L2_s_3_90.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_sp_3_90, "Pre_Processing/raster_files/L2_sp_3_90.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_3_90, "Pre_Processing/rasters_stacked/L2_3_90_add.grd", overwrite = TRUE)

writeRaster(L2_f_7_00, "Pre_Processing/raster_files/L2_f_7_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_s_7_00, "Pre_Processing/raster_files/L2_s_7_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_sp_7_00, "Pre_Processing/raster_files/L2_sp_7_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_7_00, "Pre_Processing/rasters_stacked/L2_7_00_add.grd", overwrite = TRUE)

writeRaster(L2_f_9_24, "Pre_Processing/raster_files/L2_f_9_24.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_s_9_24, "Pre_Processing/raster_files/L2_s_9_24.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_sp_9_24, "Pre_Processing/raster_files/L2_sp_9_24.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_9_24, "Pre_Processing/rasters_stacked/L2_9_24_add.grd", overwrite = TRUE)

writeRaster(L2_f_9_54_ezg, "Pre_Processing/raster_files/L2_f_9_54_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_s_9_54_ezg, "Pre_Processing/raster_files/L2_s_9_54_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_sp_9_54_ezg, "Pre_Processing/raster_files/L2_sp_9_54_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_9_54_ezg, "Pre_Processing/rasters_stacked/L2_9_54_ezg_add.grd", overwrite = TRUE)

writeRaster(L2_f_13_30, "Pre_Processing/raster_files/L2_f_13_30.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_s_13_30, "Pre_Processing/raster_files/L2_s_13_30.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_sp_13_30, "Pre_Processing/raster_files/L2_sp_13_30.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_13_30, "Pre_Processing/rasters_stacked/L2_13_30_add.grd", overwrite = TRUE)

writeRaster(L2_f_16_50, "Pre_Processing/raster_files/L2_f_16_50.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_s_16_50, "Pre_Processing/raster_files/L2_s_16_50.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_sp_16_50, "Pre_Processing/raster_files/L2_sp_16_50.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_16_50, "Pre_Processing/rasters_stacked/L2_16_50_add.grd", overwrite = TRUE)

writeRaster(L2_f_18_90, "Pre_Processing/raster_files/L2_f_18_90.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_s_18_90, "Pre_Processing/raster_files/L2_s_18_90.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_sp_18_90, "Pre_Processing/raster_files/L2_sp_18_90.tif", format = "GTiff", overwrite = TRUE)
writeRaster(L2_18_90, "Pre_Processing/rasters_stacked/L2_18_90_add.grd", overwrite = TRUE)
```

## M1
```{r}
writeRaster(M1_f_0_47, "Pre_Processing/raster_files/M1_f_0_47.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_0_47, "Pre_Processing/raster_files/M1_s_0_47.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_0_47, "Pre_Processing/raster_files/M1_sp_0_47.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_0_47, "Pre_Processing/rasters_stacked/M1_0_47_add.grd", overwrite = TRUE)

writeRaster(M1_f_0_60, "Pre_Processing/raster_files/M1_f_0_60.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_0_60, "Pre_Processing/raster_files/M1_s_0_60.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_0_60, "Pre_Processing/raster_files/M1_sp_0_60.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_0_60, "Pre_Processing/rasters_stacked/M1_0_60_add.grd", overwrite = TRUE)

writeRaster(M1_f_1_50_ezg, "Pre_Processing/raster_files/M1_f_1_50_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_1_50_ezg, "Pre_Processing/raster_files/M1_s_1_50_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_1_50_ezg, "Pre_Processing/raster_files/M1_sp_1_50_ezg.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_1_50_ezg, "Pre_Processing/rasters_stacked/M1_1_50_ezg_add.grd", overwrite = TRUE)

writeRaster(M1_f_4_00, "Pre_Processing/raster_files/M1_f_4_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_4_00, "Pre_Processing/raster_files/M1_s_4_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_4_00, "Pre_Processing/raster_files/M1_sp_4_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_4_00, "Pre_Processing/rasters_stacked/M1_4_00_add.grd", overwrite = TRUE)

writeRaster(M1_f_6_00, "Pre_Processing/raster_files/M1_f_6_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_6_00, "Pre_Processing/raster_files/M1_s_6_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_6_00, "Pre_Processing/raster_files/M1_sp_6_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_6_00, "Pre_Processing/rasters_stacked/M1_6_00_add.grd", overwrite = TRUE)

writeRaster(M1_f_8_00, "Pre_Processing/raster_files/M1_f_8_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_8_00, "Pre_Processing/raster_files/M1_s_8_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_8_00, "Pre_Processing/raster_files/M1_sp_8_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_8_00, "Pre_Processing/rasters_stacked/M1_8_00_add.grd", overwrite = TRUE)

writeRaster(M1_f_10_00, "Pre_Processing/raster_files/M1_f_10_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_10_00, "Pre_Processing/raster_files/M1_s_10_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_10_00, "Pre_Processing/raster_files/M1_sp_10_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_10_00, "Pre_Processing/rasters_stacked/M1_10_00_add.grd", overwrite = TRUE)

writeRaster(M1_f_12_00, "Pre_Processing/raster_files/M1_f_12_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_12_00, "Pre_Processing/raster_files/M1_s_12_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_12_00, "Pre_Processing/raster_files/M1_sp_12_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_12_00, "Pre_Processing/rasters_stacked/M1_12_00_add.grd", overwrite = TRUE)

writeRaster(M1_f_14_00, "Pre_Processing/raster_files/M1_f_14_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_14_00, "Pre_Processing/raster_files/M1_s_14_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_14_00, "Pre_Processing/raster_files/M1_sp_14_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_14_00, "Pre_Processing/rasters_stacked/M1_14_00_add.grd", overwrite = TRUE)

writeRaster(M1_f_16_00, "Pre_Processing/raster_files/M1_f_16_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_16_00, "Pre_Processing/raster_files/M1_s_16_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_16_00, "Pre_Processing/raster_files/M1_sp_16_00.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_16_00, "Pre_Processing/rasters_stacked/M1_16_00_add.grd", overwrite = TRUE)

writeRaster(M1_f_18_84, "Pre_Processing/raster_files/M1_f_18_84.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_18_84, "Pre_Processing/raster_files/M1_s_18_84.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_18_84, "Pre_Processing/raster_files/M1_sp_18_84.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_18_84, "Pre_Processing/rasters_stacked/M1_18_84_add.grd", overwrite = TRUE)

writeRaster(M1_f_22_84, "Pre_Processing/raster_files/M1_f_22_84.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_22_84, "Pre_Processing/raster_files/M1_s_22_84.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_22_84, "Pre_Processing/raster_files/M1_sp_22_84.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_22_84, "Pre_Processing/rasters_stacked/M1_22_84_add.grd", overwrite = TRUE)
```

## S1
```{r}
writeRaster(M1_f_22_84, "Pre_Processing/raster_files/M1_f_22_84.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_s_22_84, "Pre_Processing/raster_files/M1_s_22_84.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_sp_22_84, "Pre_Processing/raster_files/M1_sp_22_84.tif", format = "GTiff", overwrite = TRUE)
writeRaster(M1_22_84, "Pre_Processing/rasters_stacked/M1_22_84_add.grd", overwrite = TRUE)
```
S1_f_1_94_ezg <- S1_v_1_94_ezg/(sqrt(9.81 * S1_wd_1_94_ezg))
S1_f_2_00 <- S1_v_2_00/(sqrt(9.81 * S1_wd_2_00))
S1_f_3_70 <- S1_v_3_70/(sqrt(9.81 * S1_wd_3_70))
S1_f_6_50 <- S1_v_6_50/(sqrt(9.81 * S1_wd_6_50))
S1_f_8_50 <- S1_v_8_50/(sqrt(9.81 * S1_wd_8_50))
S1_f_10_68 <- S1_v_10_68/(sqrt(9.81 * S1_wd_10_68))
S1_f_13_00 <- S1_v_13_00/(sqrt(9.81 * S1_wd_13_00))
S1_f_15_00 <- S1_v_15_00/(sqrt(9.81 * S1_wd_15_00))
S1_f_18_00 <- S1_v_18_00/(sqrt(9.81 * S1_wd_18_00))
S1_f_20_00 <- S1_v_20_00/(sqrt(9.81 * S1_wd_20_00))

# Build DFs
```{r}
data_v_add <- data_v |> 
  mutate(froude = data_wd_f,
         shear_stress = data_wd_s,
         stream_power = data_wd_sp) 

data_wd_add <- data_wd |> 
  mutate(froude = data_wd_f,
         shear_stress = data_wd_s,
         stream_power = data_wd_sp) 

data_sampling_add <- data_sampling |> 
  mutate(froude = data_wd_f,
         shear_stress = data_wd_s,
         stream_power = data_wd_sp)

data_section_add <- data_section |> 
  mutate(froude = data_wd_f,
         shear_stress = data_wd_s,
         stream_power = data_wd_sp)

write.csv(data_v_add, "Pre_Processing/abiotic_mi_sampling/lab_ml_v_add.csv", row.names = FALSE)
write.csv(data_wd_add, "Pre_Processing/abiotic_mi_sampling/lab_ml_wd_add.csv", row.names = FALSE)
write.csv(data_sampling_add, "Pre_Processing/abiotic_mi_sampling/lab_ml_sampling_add.csv", row.names = FALSE)
write.csv(data_section_add, "Pre_Processing/abiotic_mi_sampling/lab_ml_section_add.csv", row.names = FALSE)
```


