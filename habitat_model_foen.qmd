---
title: "Habitat_Model_VZH"
format: html
---

# Load packages 
```{r}
#clear R environment
rm(list = ls())

# check for a package, install and load 
pkgCheck <- function(x){ 
  if (!require(x,character.only = TRUE)){
    install.packages(x,dependencies=TRUE)
    if(!require(x,character.only = TRUE)) {
      stop()
    }
  }
}

pkgCheck("raster")
pkgCheck("spsurvey")
pkgCheck("terra")
pkgCheck("raster")
pkgCheck("ggplot2")
pkgCheck("tibble")
pkgCheck("readr")
pkgCheck("dplyr")
pkgCheck("tidyr")
pkgCheck("scales")

# load self-written functions 
source("mth_functions.R")
```

# Glenner
## GL1
```{r}
GL1_3_28 <- foen_hm(raster_path = "raster_files/GL1_v_3_28.tif", 
                    base_flow = "raster_files/GL1_v_3_28.tif",
                    output_path_pers_reclass =
                      "results_foen/GL1_foen_class_pers_3_28.tif", 
                    output_path_reclass =
                      "results_foen/GL1_foen_class_3_28.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL1_foen_3_28.tif",
                    output_path_hm_persistent =
                      "results_foen/GL1_foen_pers_3_28.tif", 
                    river = "GL1", 
                    discharge = 3.28)

GL1_6_00 <- foen_hm(raster_path = "raster_files/GL1_v_6_00.tif", 
                    base_flow = "raster_files/GL1_v_6_00.tif",
                    output_path_pers_reclass =
                      "results_foen/GL1_foen_class_pers_6_00.tif", 
                    output_path_reclass =
                      "results_foen/GL1_foen_class_6_00.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL1_foen_6_00.tif",
                    output_path_hm_persistent =
                      "results_foen/GL1_foen_pers_6_00.tif", 
                    river = "GL1", 
                    discharge = 6.00)

GL1_9_00 <- foen_hm(raster_path = "raster_files/GL1_v_9_00.tif", 
                    base_flow = "raster_files/GL1_v_9_00.tif",
                    output_path_pers_reclass =
                      "results_foen/GL1_foen_class_pers_9_00.tif", 
                    output_path_reclass =
                      "results_foen/GL1_foen_class_9_00.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL1_foen_9_00.tif",
                    output_path_hm_persistent =
                      "results_foen/GL1_foen_pers_9_00.tif", 
                    river = "GL1", 
                    discharge = 9.00)

GL1_12_68 <- foen_hm(raster_path = "raster_files/GL1_v_12_68.tif", 
                    base_flow = "raster_files/GL1_v_12_68.tif",
                    output_path_pers_reclass =
                      "results_foen/GL1_foen_class_pers_12_68.tif", 
                    output_path_reclass =
                      "results_foen/GL1_foen_class_12_68.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL1_foen_12_68.tif",
                    output_path_hm_persistent =
                      "results_foen/GL1_foen_pers_12_68.tif", 
                    river = "GL1", 
                    discharge = 12.68)

GL1_16_00 <- foen_hm(raster_path = "raster_files/GL1_v_16_00.tif", 
                    base_flow = "raster_files/GL1_v_16_00.tif",
                    output_path_pers_reclass =
                      "results_foen/GL1_foen_class_pers_16_00.tif", 
                    output_path_reclass =
                      "results_foen/GL1_foen_class_16_00.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL1_foen_16_00.tif",
                    output_path_hm_persistent =
                      "results_foen/GL1_foen_pers_16_00.tif", 
                    river = "GL1", 
                    discharge = 16.00)

GL1_19_00 <- foen_hm(raster_path = "raster_files/GL1_v_19_00.tif", 
                    base_flow = "raster_files/GL1_v_19_00.tif",
                    output_path_pers_reclass =
                      "results_foen/GL1_foen_class_pers_19_00.tif", 
                    output_path_reclass =
                      "results_foen/GL1_foen_class_19_00.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL1_foen_19_00.tif",
                    output_path_hm_persistent =
                      "results_foen/GL1_foen_pers_19_00.tif", 
                    river = "GL1", 
                    discharge = 19.00)

GL1_22_00 <- foen_hm(raster_path = "raster_files/GL1_v_22_00.tif", 
                    base_flow = "raster_files/GL1_v_22_00.tif",
                    output_path_pers_reclass =
                      "results_foen/GL1_foen_class_pers_22_00.tif", 
                    output_path_reclass =
                      "results_foen/GL1_foen_class_22_00.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL1_foen_22_00.tif",
                    output_path_hm_persistent =
                      "results_foen/GL1_foen_pers_22_00.tif", 
                    river = "GL1", 
                    discharge = 22.00)

GL1_25_00 <- foen_hm(raster_path = "raster_files/GL1_v_25_00.tif", 
                    base_flow = "raster_files/GL1_v_25_00.tif",
                    output_path_pers_reclass =
                      "results_foen/GL1_foen_class_pers_25_00.tif", 
                    output_path_reclass =
                      "results_foen/GL1_foen_class_25_00.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL1_foen_25_00.tif",
                    output_path_hm_persistent =
                      "results_foen/GL1_foen_pers_25_00.tif", 
                    river = "GL1", 
                    discharge = 25.00)

GL1_28_00 <- foen_hm(raster_path = "raster_files/GL1_v_28_00.tif", 
                    base_flow = "raster_files/GL1_v_28_00.tif",
                    output_path_pers_reclass =
                      "results_foen/GL1_foen_class_pers_28_00.tif", 
                    output_path_reclass =
                      "results_foen/GL1_foen_class_28_00.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL1_foen_28_00.tif",
                    output_path_hm_persistent =
                      "results_foen/GL1_foen_pers_28_00.tif", 
                    river = "GL1", 
                    discharge = 28.00)

GL1_31_76 <- foen_hm(raster_path = "raster_files/GL1_v_31_76.tif", 
                    base_flow = "raster_files/GL1_v_31_76.tif",
                    output_path_pers_reclass =
                      "results_foen/GL1_foen_class_pers_31_76.tif", 
                    output_path_reclass =
                      "results_foen/GL1_foen_class_31_76.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL1_foen_31_76.tif",
                    output_path_hm_persistent =
                      "results_foen/GL1_foen_pers_31_76.tif", 
                    river = "GL1", 
                    discharge = 31.76)
```


## GL2
```{r}
GL2_3_21 <- foen_hm(raster_path = "raster_files/GL2_v_3_21.tif", 
                    base_flow = "raster_files/GL2_v_3_21.tif",
                    output_path_pers_reclass =
                      "results_foen/GL2_foen_class_pers_3_21.tif", 
                    output_path_reclass =
                      "results_foen/GL2_foen_class_3_21.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL2_foen_3_21.tif",
                    output_path_hm_persistent =
                      "results_foen/GL2_foen_pers_3_21.tif", 
                    river = "GL2", 
                    discharge = 3.21)

GL2_6_00 <- foen_hm(raster_path = "raster_files/GL2_v_3_21.tif", 
                    base_flow = "raster_files/GL2_v_3_21.tif",
                    output_path_pers_reclass =
                      "results_foen/GL2_foen_class_pers_3_21.tif", 
                    output_path_reclass =
                      "results_foen/GL2_foen_class_3_21.tif", 
                    HSC_path = "HSC_MI/HSC_MI.csv", 
                    col1 = "Bewohnbarkeitsklasse",
                    col2 = "HSI",
                    output_path_hm = "results_foen/GL2_foen_3_21.tif",
                    output_path_hm_persistent =
                      "results_foen/GL2_foen_pers_3_21.tif", 
                    river = "GL2", 
                    discharge = 3.21)
```
6_00, 9_00, 11_00, 12_52, 16_00, 19_00, 22_00, 25_00, 28_00, 31_53

# - Landquart: L2
```{r}
# L2 with Q: 2.4 m3/s
L2_2 <- foen_hm(raster_path = "raster_files/L2_v_2.tif", 
                base_flow = "raster_files/L2_v_2.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_2.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_2.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_2.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_2.tif", 
                river = "L2", discharge = 2.4)

# L2 with Q: 3.9 m3/s
L2_3 <- foen_hm(raster_path = "raster_files/L2_v_3.tif", 
                base_flow = "raster_files/L2_v_3.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_3.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_3.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_3.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_3.tif", 
                river = "L2", discharge = 3.9)

# L2 with Q: 4.6 m3/s
L2_4 <- foen_hm(raster_path = "raster_files/L2_v_4.tif", 
                base_flow = "raster_files/L2_v_4.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_4.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_4.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv",
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_4.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_4.tif", 
                river = "L2", discharge = 4.6)

# L2 with Q: 7 m3/s
L2_7 <- foen_hm(raster_path = "raster_files/L2_v_7.tif", 
                base_flow = "raster_files/L2_v_7.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_7.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_7.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_7.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_7.tif", 
                river = "L2", discharge = 7)

# L2 with Q: 9.24 m3/s
L2_9 <- foen_hm(raster_path = "raster_files/L2_v_9.tif", 
                base_flow = "raster_files/L2_v_9.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_9.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_9.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_9.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_9.tif", 
                river = "L2", discharge = 9.24)

# L2 with Q: 11.4 m3/s
L2_11 <- foen_hm(raster_path = "raster_files/L2_v_11.tif", 
                base_flow = "raster_files/L2_v_11.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_11.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_11.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_11.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_11.tif", 
                river = "L2", discharge = 11.4)

# L2 with Q: 13.3 m3/s
L2_13 <- foen_hm(raster_path = "raster_files/L2_v_13.tif", 
                base_flow = "raster_files/L2_v_13.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_13.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_13.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_13.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_13.tif", 
                river = "L2", discharge = 13.3)

# L2 with Q: 15 m3/s
L2_15 <- foen_hm(raster_path = "raster_files/L2_v_15.tif", 
                base_flow = "raster_files/L2_v_15.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_15.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_15.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_15.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_15.tif", 
                river = "L2", discharge = 15)

# L2 with Q: 18.9 m3/s
L2_18 <- foen_hm(raster_path = "raster_files/L2_v_18.tif", 
                base_flow = "raster_files/L2_v_18.tif",
                output_path_pers_reclass =
                  "results_foen/L2_foen_class_pers_18.tif", 
                output_path_reclass =
                  "results_foen/L2_foen_class_18.tif", 
                HSC_path = "HSC_MI/HSC_MI.csv", 
                col1 = "Bewohnbarkeitsklasse",
                col2 = "HSI",
                output_path_hm = "results_foen/foen_18.tif",
                output_path_hm_persistent =
                  "results_foen/foen_pers_18.tif", 
                river = "L2", discharge = 18.9)
```



## Moesa: MR
```{r}

```


# Bind Metric Results 
```{r}
# metrics
metric_results <- rbind(L2_2$metrics, L2_3$metrics, L2_4$metrics,
                        L2_7$metrics, L2_9$metrics, L2_11$metrics,
                        L2_13$metrics,L2_15$metrics, L2_18$metrics)

# safe df into .csv file
write.csv(metric_results, file = "results_foen/results_foen_metrics.csv", row.names = FALSE)

# freq_tables
freq_tables <- rbind(L2_2$freq, L2_3$freq, L2_4$freq, L2_7$freq, L2_9$freq,
                     L2_11$freq, L2_13$freq, L2_15$freq, L2_18$freq)

# write data frame into .csv file
write.csv(freq_tables, file = "results_foen/results_foen_freq_tables.csv", row.names = FALSE)
```




